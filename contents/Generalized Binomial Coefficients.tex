\subsection*{\GeneralizedBinomialCoefficients}
\addcontentsline{toc}{subsection}{\GeneralizedBinomialCoefficients}
\markright{\GeneralizedBinomialCoefficients}

本节讨论广义二项系数.

回忆一下: 正整数 $n$ 的阶乘 $n!$ 是前 $n$ 个正整数的积; $0$ 的阶乘 $0!$ 是 $1$.

\begin{definition}
    设 $n$ 是整数. 设 $r \in \FF[x]$. 定义广义二项系数 \term{generalized binomial coefficient} 如下:
    \begin{align*}
        \binom{r}{n} = \begin{cases}
            \frac{1}{n!} (r - 0)(r - 1) \cdots (r - (n - 1)), & \quad n > 0; \\
            1,                                                & \quad n = 0; \\
            0,                                                & \quad n < 0.
        \end{cases}
    \end{align*}
\end{definition}

广义二项系数在计数上是有用的.

从 $m$ 人里选出 $n$ 人 ($1 \leq n \leq m$, 且任意二个人都不同), 并按一定的顺序让他们坐在 $n$ 个座位上. 一个座位上至多坐一人, 且每一个选出的人都要坐在座位上. 共有多少种不同的安排座位的方法?

不难看出, 我们可以分步安排座位. 可以从 $m$ 人里选 $1$ 人坐第 $1$ 个座位, 再从剩下的 $m-1$ 人里选 $1$ 人坐第 $2$ 个座位……最后从剩下的 $m - (n - 1)$ 人里选 $1$ 人坐第 $n$ 个座位. 所以, 共有
\begin{align*}
    m \cdot (m-1) \cdot \cdots \cdot (m - (n - 1))
\end{align*}
种不同的安排座位的方法.

前面, 我们是直接按座位数选人坐座位; 现在我们先选 $n$ 人, 再让他们坐在这 $n$ 个座位上. 设从 $m$ 人里选 $n$ 人有 $C$ 种选法. 给这 $n$ 人安排座位, 有多少种不同的方法呢? 跟上面的推理完全一致: 从这 $n$ 人里选 $1$ 人坐第 $1$ 个座位, 再从剩下的 $n-1$ 人里选 $1$ 人坐第 $2$ 个座位……最后剩下的 $1$ 人坐第 $n$ 个座位. 所以, 有
\begin{align*}
    n \cdot (n - 1) \cdot \cdots \cdot 1 = n!
\end{align*}
种不同的为这 $n$ 人安排座位的方法. 进而共有
\begin{align*}
    C \cdot n!
\end{align*}
种不同的安排座位的方法.

综上, 我们有
\begin{align*}
    m \cdot (m-1) \cdot \cdots \cdot (m - (n - 1)) = C \cdot n!.
\end{align*}
由此可得, 从 $m$ 人里选 $n$ 人有
\begin{align*}
    C = \frac{m \cdot (m-1) \cdot \cdots \cdot (m - (n - 1))}{n!} = \binom{m}{n}
\end{align*}
种选法.

一般地, 我们有

\begin{proposition}
    从 $m$ 个不同的文字里选 $n$ 个的选法数为广义二项系数
    \begin{align*}
        \binom{m}{n} = \frac{m(m-1)\cdots(m - (n - 1))}{n!} = \frac{m!}{n! (m-n)!}.
    \end{align*}
\end{proposition}

\begin{pf}
    把上面的 ``人'' 换为 ``文字'', 再拟人化文字, 使其 ``坐在座位上'', 即可套用上面的推理, 从而得到第一个等号. 至于第二个等号, 直接计算即可:
    \begin{align*}
             & \frac{m(m-1)\cdots(m - (n - 1))}{n!}                                      \\
        = {} & \frac{m(m-1)\cdots(m - (n - 1))(m - n) (m - n - 1) \cdots 1}{n! (m - n)!} \\
        = {} & \frac{m!}{n! (m-n)!}. \qedhere
    \end{align*}
\end{pf}

\begin{proposition}
    广义二项系数适合如下性质:

    (i) $n \geq 0$ 时, $\binom{x}{n}$ 是首项系数为 $\frac{1}{n!}$ 的 $n$ 次整式, 前 $n$ 个非负整数恰为其根, 且
    \begin{align*}
        \binom{n}{n} = 1;
    \end{align*}

    (ii) 任取 $n \in \ZZ$, 必有
    \begin{align*}
        \binom{x + 1}{n} = \binom{x}{n} + \binom{x}{n - 1};
    \end{align*}

    (iii) 若 $m$, $n$ 是非负整数, 则
    \begin{align*}
        \sum_{\ell = 0}^{m - 1} \binom{\ell}{n} = \binom{m}{n + 1};
    \end{align*}

    (iv) 任取 $n \in \ZZ$, 必有
    \begin{align*}
        \binom{-x}{n} = (-1)^n \binom{x + n - 1}{n};
    \end{align*}

    (v) 若 $t$, $n$ 是整数, 则
    \begin{align*}
        \binom{t}{n} \in \ZZ.
    \end{align*}
\end{proposition}

\begin{pf}
    (i) $\binom{x}{0} = 1$ 是 $0$ 次整式, 无根, 首项系数为 $1$, 且 $\binom{0}{0} = 1$. $n > 0$ 时,
    \begin{align*}
        \binom{x}{n} = \frac{1}{n!} (x - 0)(x - 1) \cdots (x - (n-1)),
    \end{align*}
    故 $\binom{x}{n}$ 是首项系数为 $\frac{1}{n!}$ 的 $n$ 次整式, 且 $0$, $1$, $\cdots$, $n-1$ 恰为 $\binom{x}{n}$ 的根. 最后, 不难验证
    \begin{align*}
        \binom{n}{n} = \frac{(n-0)(n-1) \cdots (n - (n-1))}{n!} = 1.
    \end{align*}

    (ii) 若 $n<0$, 则 $\binom{x + 1}{n}$, $\binom{x}{n}$, $\binom{x}{n - 1}$ 都是 $0$, 显然. 若 $n=0$, 则 $\binom{x + 1}{n}$, $\binom{x}{n}$ 都是 $1$, 而 $\binom{x}{n - 1}$ 都是 $0$, 显然. 若 $n = 1$, 则 $\binom{x + 1}{n}$, $\binom{x}{n}$, $\binom{x}{n - 1}$ 分别是 $x+1$, $x$, $1$, 显然. 若 $n \geq 2$, 则
    \begin{align*}
             & \binom{x}{n} + \binom{x}{n - 1}                                                      \\
        = {} & \frac{x(x-1) \cdots (x-(n-2))(x-(n-1))}{n!} + \frac{x(x-1) \cdots (x-(n-2))}{(n-1)!} \\
        = {} & \frac{x(x-1) \cdots (x-(n-2))(x-(n-1))}{n!} + \frac{x(x-1) \cdots (x-(n-2))(n)}{n!}  \\
        = {} & \frac{x(x-1) \cdots (x-(n-2))(x-(n-1) + n)}{n!}                                      \\
        = {} & \frac{(x+1)x(x-1) \cdots (x-(n-2))}{n!}                                              \\
        = {} & \frac{(x+1)(x+1-1)(x+1-2) \cdots (x+1-(n-1))}{n!}                                    \\
        = {} & \binom{x + 1}{n}.
    \end{align*}

    (iii) 由 (ii) 知
    \begin{align*}
        \binom{\ell}{n} = \binom{\ell + 1}{n + 1} - \binom{\ell}{n + 1}.
    \end{align*}
    所以
    \begin{align*}
        \sum_{\ell = 0}^{m - 1} \binom{\ell}{n}
        = {} & \sum_{\ell = 0}^{m - 1} \left(-\binom{\ell}{n + 1}
        + \binom{\ell + 1}{n + 1} \right)                             \\
        = {} & -\binom{0}{n + 1} + \binom{1}{n + 1} -\binom{1}{n + 1}
        + \binom{2}{n + 1}                                            \\
             & \qquad \qquad
        + \cdots -\binom{m-1}{n + 1} + \binom{m}{n + 1}               \\
        = {} & -\binom{0}{n + 1} + \binom{m}{n + 1}                   \\
        = {} & \binom{m}{n + 1}.
    \end{align*}

    (iv) 当 $n<0$ 时, $\binom{-x}{n}$ 与 $\binom{x + n - 1}{n}$ 都是 $0$. 当 $n=0$ 时, $\binom{-x}{n}$ 与 $\binom{x + n - 1}{n}$ 都是 $1$, 且 $(-1)^n = 1$. 当 $n>0$ 时,
    \begin{align*}
        \binom{-x}{n}
        = {} & \frac{(-x)(-x-1) \cdots (-x-(n-1))}{n!}                 \\
        = {} & (-1)^n \frac{x(x+1) \cdots (x+(n-1))}{n!}               \\
        = {} & (-1)^n \frac{(x+n-1)(x+n-1-1) \cdots (x+n-1-(n-1))}{n!} \\
        = {} & (-1)^n \binom{x+n-1}{n}.
    \end{align*}

    (v) 若 $n < 0$, 则 $\binom{t}{n} = 0 \in \ZZ$. 若 $n = 0$, 则 $\binom{t}{n} = 1 \in \ZZ$. 下面考虑 $n \geq 1$ 的情形.

    我们先说明, 当 $t$ 是非负整数时, $\binom{t}{n} \in \ZZ$.

    对 $n$ 用算学归纳法. 当 $n = 1$ 时, $\binom{t}{n} = t \in \ZZ$.

    设 $n = s \geq 1$ 时, $\binom{t}{n} \in \ZZ$. 考虑 $n = s + 1$ 的情形. 由 (iii) 可知
    \begin{align*}
        \binom{t}{s + 1} = \sum_{\ell = 0}^{t - 1} \binom{\ell}{s}.
    \end{align*}
    根据归纳假设, $\binom{\ell}{s}$ ($\ell = 0$, $1$, $\cdots$, $t-1$) 都是整数, 故它们的和 $\binom{t}{s + 1}$ 也是整数. 所以, $n = s + 1$ 时, $\binom{t}{n} \in \ZZ$.

    现在考虑 $t$ 为负整数的情形. 由 (iv) 可知
    \begin{align*}
        \binom{t}{n} = (-1)^n \binom{-t + n - 1}{n} \in \ZZ.
    \end{align*}

    综上, 若 $t$, $n$ 是整数, 则 $\binom{t}{n} \in \ZZ$.
\end{pf}

性质 (i) (ii) 有计数相关的解释. 下面我们为读者提供二例.

\begin{example}
    (i) 表明, 从 $n$ 个不同的文字里选 $n$ 个的选法数是 $1$. 这是显然的, 因为所有的文字都被选中了, 也没得选.
\end{example}

\begin{example}
    此例有 ``生活的气息''. 由 (ii) 可知,
    \begin{align*}
        \binom{7}{3} = \binom{6}{2} + \binom{6}{3}.
    \end{align*}
    据说在中华人民共和国东部的浙江省, 参加 ``普通高等学校招生全国统一考试'' \term{Nationwide Unified Examination for Admissions to General Universities and Colleges} 的人, 除了有必考的语文、算学、外语, 还要从物理、化学、生物、技术、政治、历史、地理这 $7$ 个科目里选择 $3$ 个作为选考科目. 由于物理是 ``很有挑战性的科目'', 故有不少人不选物理. 上式右侧的 $\binom{6}{2}$ 表示选择物理的选法数, 而 $\binom{6}{3}$ 表示不选物理的选法数. 因为人要么选物理, 要么不选, 故它们的和就是 $7$ 选 $3$ 的选法数.
\end{example}

\begin{proposition}
    设 $n$ 是非负整数. 广义二项系数适合如下性质:

    (vi) 任意次不高于 $n$ 的整式都可唯一地写为 $\binom{x}{0}$, $\binom{x}{1}$, $\cdots$, $\binom{x}{n}$ 的线性组合;

    (vii) 设 $c_0$, $c_1$, $\cdots$, $c_n \in \FF$. 设
    \begin{align*}
        f(x) = c_0 \binom{x}{0} + c_1 \binom{x}{1} + \cdots + c_n \binom{x}{n}.
    \end{align*}
    若 $c_0$, $c_1$, $\cdots$, $c_n \in \ZZ$, 则任取 $t \in \ZZ$, 必有 $f(t) \in \ZZ$; 若 $c_0$, $c_1$, $\cdots$, $c_n$ 不全是整数, 则存在整数 $u$ 使 $f(u)$ 不是整数. 换句话说, 任取 $t \in \ZZ$, 必有 $f(t) \in \ZZ$ 的一个必要与充分条件是: $c_0$, $c_1$, $\cdots$, $c_n$ 全是整数.
\end{proposition}

\begin{pf}
    (vi) 注意到 $\binom{x}{0}$, $\binom{x}{1}$, $\cdots$, $\binom{x}{n}$ 的次分别是 $0$, $1$, $\cdots$, $n$.

    (vii) 设 $c_0$, $c_1$, $\cdots$, $c_n \in \ZZ$. 设 $t \in \ZZ$. 由 (v), $\binom{t}{0}$, $\binom{t}{1}$, $\cdots$, $\binom{t}{n}$ 都是整数, 故 $f(t)$ 也是整数.

    设 $c_0$, $c_1$, $\cdots$, $c_n$ 不全是整数. 这样, 存在 $\ell$ 使 $c_0$, $c_1$, $\cdots$, $c_{\ell - 1}$ 这 $\ell$ 个数全为整数, 而 $c_{\ell}$ 不是整数 (从左往右, 一个一个地看). 那么
    \begin{align*}
        f(\ell)
        = {} & \underbrace{c_0 \binom{\ell}{0} + c_1 \binom{\ell}{1} + \cdots
            + c_{\ell - 1} \binom{\ell}{\ell - 1}}_{\text{$\ell$ terms}}
        {} + c_{\ell} \binom{\ell}{\ell}                                       \\
             & \qquad \qquad + \underbrace{c_{\ell + 1} \binom{\ell}{\ell + 1}
        + \cdots + c_{n} \binom{\ell}{n}}_{\text{$(n - \ell)$ terms}}          \\
        = {} & (\text{an integer $q$}) + c_{\ell} + 0                          \\
        = {} & q + c_{\ell}.
    \end{align*}
    我们说, $f(\ell)$ 不是整数. 用反证法. 若 $f(\ell)$ 是整数, 因为 $q$ 也是整数, 故 $c_{\ell} = f(\ell) - q$ 是整数, 矛盾!
\end{pf}

\begin{example}
    我们知道, 若整式 $f(x)$ 的系数全为整数, 则 $t \in \ZZ$ 时 $f(t) \in \ZZ$. 不过, 反过来就不对了. 在中学, 读者也许知道 $n$ 是整数时 $\frac{n(n+1)}{2}$ 也是整数: $n$ 与 $n+1$ 必一奇一偶, 故积是偶数, 从而被 $2$ 除后仍为整数. 现在可以这么看:
    \begin{align*}
        \frac{n(n+1)}{2} = \frac{(n+1)(n+1-1)}{2} = \binom{n+1}{2}.
    \end{align*}
\end{example}

下面我们介绍二个与广义二项系数有关的和. 不过, 我们先介绍一个用完就丢的工具.

\begin{definition}
    固定某 $h \in \FF[x]$. 设 $n$ 是非负整数, $r \in \FF[x]$. 定义
    \begin{align*}
        r^{[n]} = \begin{cases}
            (r - 0)(r - h) \cdots (r - (n-1)h), & \quad n > 0; \\
            1,                                  & \quad n = 0.
        \end{cases}
    \end{align*}
\end{definition}

不难看出,
\begin{align*}
    r^{[n+1]} = r^{[n]} (r - nh).
\end{align*}
若 $h = 0$, $r^{[n]}$ 就变为 $r$ 的 $n$ 次幂. 若 $h = 1$, $r^{[n]}$ 就变为 $n! \binom{x}{n}$.

\begin{proposition}
    设 $r$, $s \in \FF[x]$. 设 $n$ 是非负整数. 则
    \begin{align*}
        (r + s)^{[n]} = \sum_{k = 0}^{n} \binom{n}{k} r^{[n - k]} s^{[k]}. \tag*{(\ding{72})}
    \end{align*}
    取 $h = 0$, 得到二项展开 \term{binomial expansion}:
    \begin{align*}
        (r + s)^{n} = \sum_{k = 0}^{n} \binom{n}{k} r^{n - k} s^{k}. \tag*{(BE)}
    \end{align*}
    取 $h = 1$, 得
    \begin{align*}
        n! \binom{r + s}{n} = \sum_{k = 0}^{n} \binom{n}{k} (n - k)! k! \binom{r}{n - k} \binom{s}{k}.
    \end{align*}
    二边同乘 $\frac{1}{n!}$, 再利用
    \begin{align*}
        \binom{n}{k} = \frac{n!}{k! (n-k)!}
    \end{align*}
    可得 Vandermonde 恒等式 \term{Vandermonde\apostrophe s identity}:
    \begin{align*}
        \binom{r + s}{n} = \sum_{k = 0}^{n} \binom{r}{n - k} \binom{s}{k}. \tag*{(VI)}
    \end{align*}
\end{proposition}

\begin{pf}
    用算学归纳法. 当 $n = 0$ 时, (\ding{72}) 的左侧是 $1$, 右侧是 $1 \cdot 1 \cdot 1$. 当 $n = 1$ 时, (\ding{72}) 的左侧是 $r + s$, 右侧是 $1 \cdot r \cdot 1 + 1 \cdot 1 \cdot s$.

    设 $n = \ell \geq 1$ 时, (\ding{72}) 正确, 即
    \begin{align*}
        (r + s)^{[\ell]} = \sum_{k = 0}^{\ell} \binom{\ell}{k} r^{[\ell - k]} s^{[k]}. \tag*{(\ding{72})}
    \end{align*}
    现在, 考虑 $n = \ell + 1$ 的情形:
    \begin{align*}
             & (r + s)^{[\ell + 1]}                                                                                                                              \\
        = {} & (r + s)^{[\ell]} (r + s - \ell h)                                                                                                                 \\
        = {} & \sum_{k = 0}^{\ell} \binom{\ell}{k} r^{[\ell - k]} s^{[k]} (r + s - \ell h)                                                                       \\
        = {} & \sum_{k = 0}^{\ell} \binom{\ell}{k} r^{[\ell - k]} s^{[k]} (r + s - (\ell - k + k) h)                                                             \\
        = {} & \sum_{k = 0}^{\ell} \binom{\ell}{k} r^{[\ell - k]} s^{[k]} ((r - (\ell - k) h) + (s - k h))                                                       \\
        = {} & \sum_{k = 0}^{\ell} \binom{\ell}{k} (r^{[\ell - k]} (r - (\ell - k) h) s^{[k]} + r^{[\ell - k]} s^{[k]} (s - k h))                                \\
        = {} & \sum_{k = 0}^{\ell} \binom{\ell}{k} (r^{[\ell - k + 1]} s^{[k]} + r^{[\ell - k]} s^{[k + 1]})                                                     \\
        = {} & \sum_{k = 0}^{\ell} \binom{\ell}{k} r^{[\ell + 1 - k]} s^{[k]} + \sum_{k = 0}^{\ell} \binom{\ell}{k} r^{[\ell - k]} s^{[k + 1]}                   \\
        = {} & \sum_{k = 0}^{\ell} \binom{\ell}{k} r^{[\ell + 1 - k]} s^{[k]} + \sum_{k = 0}^{\ell} \binom{\ell}{k + 1 - 1} r^{[\ell + 1 - (k + 1)]} s^{[k + 1]} \\
        = {} & \sum_{k = 0}^{\ell} \binom{\ell}{k} r^{[\ell + 1 - k]} s^{[k]} + \sum_{k = 1}^{\ell + 1} \binom{\ell}{k - 1} r^{[\ell + 1 - k]} s^{[k]}           \\
        = {} & \sum_{k = 0}^{\ell + 1} \binom{\ell}{k} r^{[\ell + 1 - k]} s^{[k]} + \sum_{k = 0}^{\ell + 1} \binom{\ell}{k - 1} r^{[\ell + 1 - k]} s^{[k]}       \\
        = {} & \sum_{k = 0}^{\ell + 1} \left( \binom{\ell}{k} + \binom{\ell}{k - 1} \right) r^{[\ell + 1 - k]} s^{[k]}                                           \\
        = {} & \sum_{k = 0}^{\ell + 1} \binom{\ell + 1}{k} r^{[\ell + 1 - k]} s^{[k]}. \qedhere
    \end{align*}
\end{pf}

\begin{remark}
    Too cruel though it is, let\apostrophe s say \textit{farewell} to $r^{[n]}$. We will not use $r^{[n]}$ any longer from this moment forward. It is born to be a good old tool for us. May $r^{[n]}$ and its soul rest in peace!
\end{remark}

\begin{example}
    (VI) 也有计数相关的解释. 老规矩, 先写下算式:
    \begin{align*}
        \binom{7}{3}
        = \binom{3}{3} \binom{4}{0}
        + \binom{3}{2} \binom{4}{1}
        + \binom{3}{1} \binom{4}{2}
        + \binom{3}{0} \binom{4}{3}.
    \end{align*}

    回到中华人民共和国东部的浙江省. 回到 ``普通高等学校招生全国统一考试''. 前面提到, 在那儿, 参加考试的人从 $7$ 科目里选 $3$ 个. 政治、历史、地理是偏 ``阿先生'' \term{arts} 的; 物理、化学、生物、技术是偏 ``赛先生'' \term{science} 的.

    $7$ 选 $3$ 可以这么选:

    (i) 选 $3$ 个阿先生与 $0$ 个赛先生: $\binom{3}{3} \binom{4}{0}$;

    (ii) 或者, 选 $2$ 个阿先生与 $1$ 个赛先生: $\binom{3}{2} \binom{4}{1}$;

    (iii) 或者, 选 $1$ 个阿先生与 $2$ 个赛先生: $\binom{3}{1} \binom{4}{2}$;

    (iv) 或者, 选 $0$ 个阿先生与 $3$ 个赛先生: $\binom{3}{0} \binom{4}{3}$.

    把这 $4$ 种情形下的选法数相加, 就是 $\binom{7}{3}$.
\end{example}
