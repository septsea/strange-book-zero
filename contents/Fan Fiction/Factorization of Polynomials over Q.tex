\subsection*{\FactorizationOfPolynomialsOverQ}
\addcontentsline{toc}{subsection}{\FactorizationOfPolynomialsOverQ}
\markright{\FactorizationOfPolynomialsOverQ}

To be completed.

作者将在本文为读者介绍有理系数多项式的因子分解.

读者可能还能想起这个命题:
\begin{proposition}
    设多项式 $f$ 既不是 $0$, 也不是单位.

    (i) 存在不可约的多项式 $p_1$, $p_2$, $\cdots$, $p_m$ 使
    \begin{align*}
        f = p_1 p_2 \cdots p_m;
    \end{align*}

    (ii) 若 $q_1$, $q_2$, $\cdots$, $q_m$, $s_1$, $s_2$, $\cdots$, $s_n$ 是不可约的多项式, 且
    \begin{align*}
        f = q_1 q_2 \cdots q_m = s_1 s_2 \cdots s_n,
    \end{align*}
    则 $m = n$, 且可以适当地调换 $s_1$, $s_2$, $\cdots$, $s_m$ 的顺序, 使任取 $1$ 至 $m$ 间的整数 $\ell$, $q_\ell$ 与 $s_\ell$ 相伴 (注意: 调换顺序后的 $s_\ell$ 不一定跟原来的 $s_\ell$ 相等!).
\end{proposition}

如果读者还能回忆起此命题的证明, 读者就会发现: 我们只要知道 $1$ 次多项式是不可约的就够了 (算学归纳法的始条件: 命题对次为 $1$ 的多项式成立). 换句话说, 虽然此命题断言, 我们可写既不是 $0$, 也不是单位的多项式为若干个不可约的多项式的积, 但它可没告诉我们怎么写. 本文就是要告诉读者一个具体的写法.

作者先提醒读者: 或许, 本文跟 ``\FactorizationOfIntegers '' 类似; 读者可对比阅读二文.

在进入正题前, 作者先给出因子分解的定义.

\begin{example}
    事实上, 我们在初中就学习了如何 ``因式分解'' 多项式\myFN{这里, ``因式'' 就是我们常说的 ``因子''. 在算学里, 整数的 ``因子'' 是 ``因数'', 多项式的 ``因子'' 是 ``因式''. 不过, 我们在此统一使用 ``因子''.}. 作者查阅了初中算学课本. 在人民教育出版社出版的算学课本\myFN{感兴趣的读者可进入 \texttt{https://mp.weixin.qq.com/s/YBX0oYzlADELmtjOM-wJaw}; 八年级, 上册; 114 页.}里, 因式分解被描述为:
    \begin{quotation}
        (探究) 请把下列多项式写成整式的积的形式;

        (1) $x^2 + x$;

        (2) $x^2 - 1$.

        ~\

        根据整式的乘法, 可以联想得到
        \begin{align*}
             & x^2 + x = x(x+1),         \\
             & x^2 - 1 = (x + 1)(x - 1).
        \end{align*}

        上面我们把一个多项式化成了几个整式的积的形式, 像这样的式的变形叫作多项式的因式分解 \term{factorization}, 也叫作把这个多项式分解因式.
    \end{quotation}

    作者顺便提一下 ``整式'' 是什么. 在中学课本里, ``数或字母的积'' 是 ``单项式'' (如 $100t$, $0.8p$, $mn$, $a^2 h$, $-n$, $36$, $x$); 几个 ``单项式'' 的和是 ``多项式'' (如 $v + 2.5$, $v - 2.5$, $3x + 5y + 2z$, $\frac{1}{2}ab - \frac{1}{2} \cdot 2\pi r^2$, $x^2 + 2x + 18$); ``单项式'' 与 ``多项式'' 统称 ``整式''. 由此可见, 中学的 ``多项式'' 似乎不包括 $1$, $x$, $x^2$, $\cdots$, $x^n$; ``多项式'' 与 ``多项式'' 的和不一定是 ``多项式'' (如 $(x^2 + 1) + (-x^2)$); $2x + 3x$ 是 ``多项式'', 但是与其相等的 $5x$ 却只能是 ``单项式''. 不过, 也有中学算学教材 (作者还是中学生时, 学习湖南教育出版社的算学教材; 在初一下学期时, 作者就学了因式分解) 指出: ``在摩登算学文献中, 把单项式看成是只有一项的多项式.'' 也就是说, 在摩登算学文献中, ``多项式'' 就是中学课本的 ``整式''. 相应地, 因式分解被定义为: ``一般地, 把一个多项式表示成若干个多项式的积的形式, 称为把这个多项式因式分解.''

    现在, 作者提出一个问题: $1$ 是不是多项式? 如果是, 那么任意的多项式 $f$ 均可写为几个多项式的积: $f = 1 \cdot f$. 这样, 我们根本就不必讨论因式分解了! 所以, 看上去, $1$ 不是多项式! 不过, 如果 $1$ 不是多项式, 那么 $1$ 是什么呢? 仅仅是一个数? 又或者说, 什么都不是?

    读者可能会说: 分解因式, 必须进行到每一个多项式因式都不能再分解为止. 彳亍. 那么, 作者再排出几个问题: 什么是 ``不能再分解''? $3x + 2$ 能不能再分解? $4x - 8$ 能不能再分解? $-x - 1$ 能不能再分解? $x^2 - 2$ 能不能再分解? 或许, 读者认为 $3x + 2$ 不能再分解, 而 $4x - 8$ 还能再分解, 是吧? 作者知道读者怎么想: $4x - 8 = 4(x - 2)$, 对不? 可这个 $4$ 能不能再分解? $4 = 2 \cdot 2$, 对吧? 读者为什么不写 $4x - 8 = 2 \cdot 2 \cdot (x-2)$ 呢? $-x - 1$ 能不能写为 $(-1) \cdot (x+1)$? $x^2 - 2$ 能不能写为 $(x - \sqrt{2}) \cdot (x + \sqrt{2})$?

    由此可见, 读者在中学算学里学到的 ``因式分解'' 不是十分清楚. 作者的任务就是: 清楚地写出本文的 (显然作者无法让别的地方的) ``有理系数多项式的因子分解'' 的含义.

    作者顺便提一下, 作者在互联网上看到很多关于 $0.\dot{9}$ (零点九, 九循环) 与 $1$ 的大小关系的讨论了. 由于不明确 $0.\dot{9}$ 的定义, 大家就在说 ``这不对!'' ``这有大问题!'' 等评论. 由于此问题的详尽的讨论需要微积分, 作者就不在这里讨论这个问题了. 作者的目的是: 告诉读者 ``定义很重要!''.
\end{example}

跟整数的因子分解类似, 作者给出
\begin{definition}
    设 (有理系数) 多项式 $f \neq 0$. 那么, $f$ 一定可写为 (至多一个; 因为有限多个单位的积还是单位) (有理系数多项式的) 单位与有限多个 (可以是零个) (有理系数多项式的) 不可约的多项式的积, 即: 存在单位 $\varepsilon$ 与不可约的多项式 $p_1$, $p_2$, $\cdots$, $p_s$ ($s$ 可为 $0$; 此时, $f$ 是单位) 使
    \begin{align*}
        f = \varepsilon p_1 p_2 \cdots p_s.
    \end{align*}
    上式右侧即为 $f$ 的因子分解 \term{factorization of $f$}. 动词短语 ``写 $f$ 为单位与有限多个不可约的多项式的积'' 的一个简单的称呼是 ``因子分解 $f$'' \term{to factorize $f$}.
\end{definition}

\begin{remark}
    依此定义, $3x + 2$, $4x - 8$, $-x - 1$ 的因子分解可以是自身. 当然, $2(2x - 4)$ 也是 $4x - 8$ 的一个因子分解; 甚至, $\frac{1}{5} (15x + 10)$ 也是 $3x + 2$ 的一个因子分解. 这些差异, 在 ``单位'' ``相伴'' 下, 不是差异!

    $x^2 - 2$ (作为有理系数多项式) 是不可约的 (Eisenstein 判别法). 而且, 我们在本文里, 不考虑系数不全是有理数的多项式. 所以, $(x - \sqrt{2}) \cdot (x + \sqrt{2})$ 自然是 ``跑远了''.
\end{remark}

\begin{remark}
    有时, 为书写方便, 允许在因子分解里出现幂. 比如说, 设
    \begin{align*}
        f = (x-1) \cdot (x-1) \cdot (x-1) \cdot (5x-20) \cdot (5x-20).
    \end{align*}
    上式右侧已经是 $f$ 的因子分解了. 不过, 为了方便, 我们可以认为,
    \begin{align*}
        (x-1)^3 (5x-20)^2
    \end{align*}
    也是 $f$ 的因子分解. 此时, 我们视 $(x-1)^3$ (或 $(5x-20)^2$) 为 $3$ 个 $x-1$ 的积 (或 $2$ 个 $5x-20$ 的积), 而不是一个不可约的多项式!
\end{remark}

事实上, 我们已经在 ``\RationalRootsOfPolynomialsOverQ '' ``\FactorsOfHigherDegreeOfPolynomialsOverQ '' 里讨论过因子分解的方法了——我们讨论了如何寻找有理系数多项式的不可约的因子. 仔细的读者可能注意到, 我们一直在说 ``试写某多项式为 (若干个) 不可约的多项式的积'', 而不是直接说 ``因子分解某多项式''——这是因为我们还未明确 ``因子分解'' 的确切含义.

一个好想法是从重因子入手. 设 $f(x) \neq 0$. 读者可能还能记起, 若 $M(x)$ 是 $f(x)$ 与 $Df(x)$ 的最大公因子, 则 $f(x)$ 有重因子的一个必要与充分条件是 $M(x)$ 不是单位. 进一步, 若 $h(x)$ 适合 $f(x) = h(x)M(x)$, 则 $h(x)$ 与 $f(x)$ 有相同的不可约的因子, 但 $h(x)$ 无重因子. 这有什么好处呢? 当时作者在 ``\MultipleFactors '' 里没说此性质的好处. 现在, 请读者看下面的例.

\begin{example}
    设 $f(x) = x^6-2 x^5-8 x^4+14 x^3+11 x^2-28 x+12$. 我们先试着找 $1$ 次因子 (也就是有理根). 首先, $x$ 不是 $f(x)$ 的因子. 因为 $f(x)$ 的首项系数是单位, 故 $f(x)$ 的有理根一定是整数 $v$, 且 $v$ 还是 $0$ 次系数 $12$ 的因子. 所以, $v$ 可能是
    \begin{align*}
        \pm 1, \pm 2, \pm 3, \pm 4, \pm 6, \pm 12.
    \end{align*}
    还是老样子, 我们打算用 ``$v \pm u$'' 检验排除一些不可能是 $f(x)$ 的根的数 (这里 $u = 1$). 我们希望 $f(1) \neq 0$. 利用综合除法, 我们有
    \begin{align*}
        f(x) = (x - 1) \underbrace{(x^5-x^4-9 x^3+5 x^2+16 x-12)}_{g_1 (x)}.
    \end{align*}
    $1$ 居然是 $f(x)$ 的根! 不过, 这也不是坏事. $g_1 (x)$ 的首项系数仍为单位, 且其 $0$ 次系数是 $f(x)$ 的 $0$ 次系数的相伴, 故 $g_1 (x)$ 的有理根仍可能是上面的 $12$ 个整数的一个. 还是用 $1$ 试; 我们希望 $g_1 (1) \neq 0$. 不过
    \begin{align*}
        g_1 (x) = (x - 1) \underbrace{(x^4-9 x^2-4 x+12)}_{g_2 (x)}.
    \end{align*}
    $1$ 居然也是 $g_1 (x)$ 的根! 也就是说, $(x-1)^2$ 是 $f(x)$ 的因子! 事实上, 读者可继续用 $x-1$ 除 $g_2 (x)$:
    \begin{align*}
        g_2 (x) = (x - 1) \underbrace{(x^3+x^2-8 x-12)}_{g_3 (x)}.
    \end{align*}
    再用 $x-1$ 除 $g_3 (x)$:
    \begin{align*}
        g_3 (x) = (x - 1) (x^2 + 2x - 6) - 18.
    \end{align*}
    由此可见, $f(x) = (x-1)^3 g_3 (x)$, 且 $x-1$ 不再是 $g_3 (x)$ 的因子. 还有一点请读者注意: 我们还没试 $-1$ 呢. 当然, 读者可用综合除法算出
    \begin{align*}
        g_3 (x) = (x + 1)(x^2 - 8) - 4.
    \end{align*}
    也就是说, $x+1$ 不是 $g_3 (x)$ 的因子. 现在, 总算可以用 ``$v \pm u$'' 检验了. $-4 = (-1) \cdot 2^2$, 故 $-4$ 的因子数为 $2 \cdot (1+2) = 6$; $-18 = (-2) \cdot 3^2$, 故 $-18$ 的因子数为 $2 \cdot (1+1) \cdot (1+2) = 12$. 我们从 $-4$ 入手. 因为 $v + u = v + 1$ 一定是 $g_3 (-1) = -4$ 的因子, 故恰有 $3$ 个数通过 ``$v + u$'' 检验: $-2$, $3$, $-3$. 再看 $-18$. 因为 $v - u = v - 1$ 一定是 $g_3 (1) = -18$ 的因子, 故恰有 $2$ 个数又通过 ``$v - u$'' 检验: $-2$, $3$. 继续进行综合除法, 发现 $-2$ 是 $g_3 (x)$ 的根:
    \begin{align*}
        g_3 (x) = (x + 2) \underbrace{(x^2 - x - 6)}_{g_4 (x)}.
    \end{align*}
    我们可直接对 $g_4 (x)$ 作如下变形:
    \begin{align*}
        g_4 (x)
        = {} & \frac{1}{4} (4x^2 - 4x - 24)                   \\
        = {} & \frac{1}{4} ((2x)^2 - 2 (2x) \cdot 1 - 24)     \\
        = {} & \frac{1}{4} ((2x)^2 - 2 (2x) \cdot 1 + 1 - 25) \\
        = {} & \frac{1}{4} ((2x - 1)^2 - 5^2)                 \\
        = {} & \frac{1}{4} (2x - 1 - 5) (2x - 1 + 5)          \\
        = {} & (x - 3) (x + 2).
    \end{align*}
    换句话说,
    \begin{align*}
         & g_4 (x) = (x + 2) (x - 3),          \\
         & g_3 (x) = (x + 2)^2 (x - 3),        \\
         & f(x) = (x - 1)^3 (x + 2)^2 (x - 3).
    \end{align*}
    我们发现, $x-1$ 与 $x+2$ 都是重因子. $x-1$ 一直影响我们的发挥——我们连除三次才消去了 $x-1$. $x+2$ 呢? 好在 $f(x)$ 的次不是很高, 我们用 $2$ 次式的技巧, 避开了除法. 但读者也不难看出: 若我们 ``机械地'' 判断 $g_4 (x)$ 的有理根, 那么 $-2$ 与 $3$ 仍为 ``候选根''. 我们用综合除法可判断一个数是不是多项式的根, 但却不知道它是否会重复出现.
\end{example}

\begin{example}
    还是用 $f(x) = x^6-2 x^5-8 x^4+14 x^3+11 x^2-28 x+12$. 不过, 这次, 我们先看 $f(x)$ 有无重因子. 读者应该还记得求微商的法则吧? (如果不记得了, 就再往前看看.) 不难写出
    \begin{align*}
        Df(x) = 6 x^5-10 x^4-32 x^3+42 x^2+22 x-28.
    \end{align*}
    用 $Df(x)$ 除 $f(x)$:
    \begin{align*}
        f(x) = \frac{3x-1}{18} Df(x) - \frac{1}{9} \underbrace{(29 x^4-47 x^3-87 x^2+199 x-94)}_{r_0 (x)}.
    \end{align*}
    用 $r_0 (x)$ 除 $Df(x)$:
    \begin{align*}
        Df(x) = \frac{2}{841} (87x-4) r_0 (x) - \frac{12\,150}{841} \underbrace{(x^3-3 x+2)}_{r_1 (x)}.
    \end{align*}
    用 $r_1 (x)$ 除 $r_0 (x)$:
    \begin{align*}
        r_0 (x) = (29x-47) r_1 (x).
    \end{align*}
    由此可见, $r_1 (x)$ 就是 $f(x)$ 与 $Df(x)$ 的最大公因子. 因为 $r_1 (x)$ 不是单位, 故 $f(x)$ 有重因子. 用 $r_1 (x)$ 除 $f(x)$:
    \begin{align*}
        f(x) = r_1 (x) \underbrace{(x^3-2 x^2-5 x+6)}_{h(x)}.
    \end{align*}
    接下来该怎么办呢? 我们可以先找 $h(x)$ 的有理根, 从而得到 $h(x)$ 的 $1$ 次因子. $h(x)$ 的 $1$ 次因子是 $f(x)$ 的 $1$ 次因子. 不仅如此, $r_1 (x)$ 的不可约的因子也一定是 $h(x)$ 的因子\myFN{因为 $r_1 (x)$ 的不可约的因子是 $f(x)$ 的重因子, 而 $f(x)$ 的重因子, 至少, 按定义, 是不可约的. $f(x)$ 的不可约的因子都是 $h(x)$ 的因子.}. 所以, $h(x)$ 的因子分解可帮助我们找出 $r_1 (x)$ 的因子分解. $f(x) = r_1 (x) h(x)$, 故 $f(x)$ 的因子分解就是 $h(x)$ 与 $r_1 (x)$ 的因子分解的合并. 因为 $h(x)$ 无重因子, 故找出 $h(x)$ 的一个 (不是单位的) 因子 $p(x)$, 得 $h(x) = p(x) \ell(x)$ 后, 就不必判断 $p(x)$ 是否为 $\ell (x)$ 的因子了.

    我们就拿上面的 $h(x)$ 举例. 老样子, $h(x)$ 的有理根 $v$ 一定是 ($6$ 的因子):
    \begin{align*}
        \pm 1, \pm 2, \pm 3, \pm 6.
    \end{align*}
    先试 $\pm 1$. 利用综合除法, 可得
    \begin{align*}
        h(x) = (x - 1) \underbrace{(-6 - x + x^2)}_{h_1 (x)}.
    \end{align*}
    老样子, $h_1 (x)$ 的有理根 $v$ 一定是 ($-6$ 的因子):
    \begin{align*}
        \pm 1, \pm 2, \pm 3, \pm 6.
    \end{align*}
    不过, $x-1$ 不再是 $h_1 (x)$ 的因子了. 利用综合除法, 我们有
    \begin{align*}
        h_1 (x) = (x + 1) (x - 2) - 4.
    \end{align*}
    所以, $x+1$ 也不是 $h_1 (x)$ 的因子. 当然, 就算 $x-1$ 不是 $h_1 (x)$ 的因子, 我们还是要知道 $h_1 (1)$:
    \begin{align*}
        h_1 (x) = (x - 1) x - 6.
    \end{align*}
    由此可见, $v - u = v - 1$ 一定是 $h_1 (1) = -6$ 的因子, 且 $v + u = v + 1$ 一定是 $h_1 (-1) = -4$ 的因子. 由此, 我们可排除 $2$, $-3$, $6$, $-6$, 从而还剩 $-2$, $3$. 接下来不难检验, $-2$ 与 $3$ 都是 $h_1 (x)$ 的根:
    \begin{align*}
        h_1 (x) = (x + 2) (x - 3).
    \end{align*}
    由此可知
    \begin{align*}
        h(x) = (x - 1) (x + 2) (x - 3).
    \end{align*}
    还剩 $r_1 (x)$. 我们可以用 $h(x)$ 帮助我们. $r_1 (x) = x^3 - 3x + 2$, 故 $3$ 不可能是 $r_1 (x)$ 的根. 也就是说, $x - 3$ 不是 $r_1 (x)$ 的因子 (故 $x - 3$ 不是 $f(x)$ 的重因子!). 因为 $-1$, $2$ 不是 $h(x)$ 的根, 故 $x+1$, $x-2$ 不可能是 $r_1 (x)$ 的因子. 还有 $x - 1$ 与 $x + 2$. 根据综合除法, 我们得到
    \begin{align*}
        r_1 (x) = (x - 1) (x^2 + x - 2) = (x - 1) (x - 1) (x + 2).
    \end{align*}
    所以
    \begin{align*}
        f(x) = h(x) r_1 (x) = (x-1)^3 (x+2)^2 (x-3).
    \end{align*}
\end{example}

综上, 欲因子分解 $f(x)$, 可以这样:

(i) 求 $Df(x)$.

(ii) 找 $f(x)$ 与 $Df(x)$ 的一个最大公因子 $M(x)$.

(iii) 设 $f(x) = h(x) M(x)$, 则 $f(x)$ 的不可约的因子都是 $h(x)$ 的因子, 且 $h(x)$ 不再有重因子. 因为 $M(x)$ 包含 $f(x)$ 的重因子, 故 $M(x)$ 的不可约的因子也是 $h(x)$ 的因子.

(iv) 因子分解 $h(x)$. 好消息: 若不是单位的 $p(x)$ 使 $h(x) = p(x) \ell(x)$, 则 $p(x)$ 一定不是 $\ell (x)$ 的因子.

(v) 借助 $h(x)$ 的因子分解, 并结合其他事实, 写出 $M(x)$ 的因子分解. 当然, 我们也可以利用 $M(x)$ 与 $DM(x)$ 的最大公因子来判断 $M(x)$ 有无重因子.

(vi) 合并 $h(x)$ 与 $M(x)$ 的因子分解, 即得 $f(x)$ 的因子分解.

不过, 读者可能会想: 我们该如何因子分解 $h(x)$ 呢? 如果 $h(x)$ 有有理根, 那还不是很大的问题; 如果 $h(x)$ 无有理根, 我们又不会了! 就算重因子可帮助我们找高次因子, 但它找出的高次因子不一定是不可约的. 我们还得研究 $h(x)$, 从而得出 $M(x)$ 的因子分解. 下面, 作者将讨论此问题.

读者辛苦了! 请读者休息一会儿, 并复习 ``\Interpolation '' 的知识.

\myLine

前面, 我们了解了如何用重因子试探多项式的因子. 如果 $f(x)$ 没有重因子, 怎么办? 所以, 我们需要别的方法.
