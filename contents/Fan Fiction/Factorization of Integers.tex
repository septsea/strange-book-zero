\subsection*{\FactorizationOfIntegers}
\addcontentsline{toc}{subsection}{\FactorizationOfIntegers}
\markright{\FactorizationOfIntegers}

作者将在本文为读者介绍整数的因子分解, 并告诉读者如何寻找整数的所有因子.

读者可能还能想起这个命题 (算术基本定理):
\begin{proposition}
    设整数 $f$ 既不是 $0$, 也不是单位.

    (i) 存在不可约的整数 $p_1$, $p_2$, $\cdots$, $p_m$ 使
    \begin{align*}
        f = p_1 p_2 \cdots p_m;
    \end{align*}

    (ii) 若 $q_1$, $q_2$, $\cdots$, $q_m$, $s_1$, $s_2$, $\cdots$, $s_n$ 是不可约的整数, 且
    \begin{align*}
        f = q_1 q_2 \cdots q_m = s_1 s_2 \cdots s_n,
    \end{align*}
    则 $m = n$, 且可以适当地调换 $s_1$, $s_2$, $\cdots$, $s_m$ 的顺序, 使任取 $1$ 至 $m$ 间的整数 $\ell$, $q_\ell$ 与 $s_\ell$ 相伴 (注意: 调换顺序后的 $s_\ell$ 不一定跟原来的 $s_\ell$ 相等!).
\end{proposition}

如果读者还能回忆起此命题的证明, 读者就会发现: 我们只要知道 $\pm 2$ 是不可约的就够了 (算学归纳法的始条件: 命题对绝对值为 $2$ 的整数成立). 甚至, $\pm 3$ 是不是可约的不影响此命题的证明: 如果 $\pm 3$ 是可约的, 根据可约的整数的定义, 我们将它写为二个不是单位的整数的积, 然后再对这二个整数进行讨论; 如果 $\pm 3$ 是不可约的, 则不必证了. (当然, 正如读者所想象的那样, $\pm 3$ 是不可约的.) 换句话说, 虽然此命题断言, 我们可写既不是 $0$, 也不是单位的整数为若干个不可约的整数的积, 但它可没告诉我们怎么写. 本文就是要告诉读者一个具体的写法.

在前面, 我们稍细致地讨论了不可约的整式\myFN{这里的整式的系数是有理数.}, 并知道, 任取非负整数 $N$, 必有次高于 $N$ 的不可约的整式\myFN{但是, 不可约的复系数整式的次一定是 $1$; 不可约的实系数整式的次一定是 $1$ 或 $2$. 由于作者不假定读者有实分析 (这里的 ``实分析'' 是 ``广义的'': 研究实数的子集到实数的函数的学问) 或复分析 (类似地, ``复分析'' 是研究复数的子集到复数的函数的学问) 的知识, 故作者无法详细地展开这些事实. 读者可参考任意一本讲 ``高等代数'' 的教材.} (如 $x^{N+1} + 2$). 类似地, 我们也有
\begin{proposition}
    设 $N$ 是非负整数. 存在不可约的整数 $p$ 使 $|p| > N$. 通俗地说, 有无限多个不可约的整数.
\end{proposition}

\begin{pf}
    设 $N$ 是某非负整数. 用反证法. 假定不存在不可约的整数 $p$ 使 $|p| > N$; 也就是说, 每个不可约的整数 $p$ 都适合 $|p| \leq N$. 因为适合条件 $|t| \leq N$ 的非负整数 $t$ 至多有 $2N + 1$ 个\myFN{也就是 $0$, $1$, $-1$, $2$, $-2$, $\cdots$, $N$, $-N$.}, 故只有有限多个不可约的整数. 设 $p_1$, $p_2$, $\cdots$, $p_s$ 是所有的不可约的整数. 考虑整数
    \begin{align*}
        M = |p_1| \cdot |p_2| \cdots |p_s| + 1.
    \end{align*}
    任取一个不可约的整数 $p_\ell$. 因为不可约的整数的绝对值不低于 $1$, 故
    \begin{align*}
        M \geq |p_\ell| + 1 > |p_\ell|.
    \end{align*}
    所以, $M$ 不等于 $p_\ell$. 换句话说, $M$ 不是不可约的整数. 因为 $|p_\ell| \geq 1$, 故 $M \geq 2$. 所以, $M$ 既不是 $0$, 也不是单位. 所以, $M$ 是可约的. 既然 $M$ 是可约的, 那必有某个不可约的整数 $p_k$ 是 $M$ 的因子. $p_k$ 当然也是 $|p_1| \cdot |p_2| \cdots |p_s|$ 的因子. 所以 $p_k$ 也是
    \begin{align*}
        1 = M - |p_1| \cdot |p_2| \cdots |p_s|
    \end{align*}
    的因子. $1$ 当然是 $p_k$ 的因子, 故 $p_k$ 与 $1$ 相伴. 所以 $p_k$ 是单位. 矛盾!
\end{pf}

前面, 我们知道: 有无限多个不可约的整数. 那么, 不可约的整数有什么特征呢? 作者给一个简单的命题.

\begin{proposition}
    设 $p$ 是整数, 且 $|p| \geq 5$. 若 $p$ 是不可约的, 则存在整数 $\ell$ 使 $p = 6\ell + 1$ 或 $p = 6\ell + 5$.
\end{proposition}

\begin{pf}
    既然 $p$ 是整数, 那么一定存在唯一的一对整数 $q$, $r$ 使
    \begin{align*}
        p = 6q + r, \quad 0 \leq r \leq 5.
    \end{align*}

    假定 $p = 6q$. 因为 $|p| \geq 5$, 故 $p \neq 0$. 所以 $q \neq 0$. 因为 $p = 2 \cdot 3q$, 而 $2$ 不是单位, $3q$ 也不是单位 (因为 $|3q| = 3|q| \geq 3$), 这与 $p$ 是不可约的矛盾!

    假定 $p = 6q + 2 = 2(3q + 1)$. 因为 $|p| \geq 5$, 故 $|3q + 1| \geq \frac{5}{2}$. 因为 $3q + 1$ 是整数, 故 $|3q + 1| \geq 3$. $2$ 不是单位, 且 $3q + 1$ 也不是单位. 这与 $p$ 是不可约的矛盾.

    假定 $p = 6q + 3 = 3(2q + 1)$. 因为 $|p| \geq 5$, 故 $|3q + 1| \geq \frac{5}{3}$. 因为 $3q + 1$ 是整数, 故 $|3q + 1| \geq 2$. $3$ 不是单位, 且 $2q + 1$ 也不是单位. 这与 $p$ 是不可约的矛盾.

    假定 $p = 6q + 4 = 2(3q + 2)$. 因为 $|p| \geq 5$, 故 $|3q + 2| \geq \frac{5}{2}$. 因为 $3q + 2$ 是整数, 故 $|3q + 2| \geq 3$. $2$ 不是单位, 且 $3q + 2$ 也不是单位. 这与 $p$ 是不可约的矛盾.

    综上, 若 $|p| \geq 5$, 且 $p$ 是不可约的, 则 $p = 6q + 1$ 或 $p = 6q + 5$. 取 $\ell = q$ 即可.
\end{pf}

\begin{remark}
    读者可能听说过, $25 = 5 \cdot 5$. $5$ 不是单位, 故 $25$ 是可约的. 不过, $25 = 6 \cdot 4 + 1$. 类似地, $143 = 11 \cdot 13$. $11$ 与 $13$ 都不是单位, 故 $143$ 也是可约的. 不过, $143 = 6 \cdot 23 + 5$. 此评注的目的是告诉读者, 上个命题反过来不一定对. 换句话说, 不是所有的 $6\ell + 1$ 或 $6\ell + 5$ 都是不可约的.
\end{remark}

设 $f$ 既不是 $0$, 也不是单位. 判断 $f$ 是否是不可约的整数的最简单的方法可能是试除法. 设 $N = |f|$. 若 $f$ 是不可约的, 则不存在整数 $f_1$, $f_2$ 使 $f = f_1 f_2$, 且 $2 \leq |f_1| < N$, $2 \leq |f_2| < N$; 反之也对. 适合条件 $2 \leq |t| < N$ 的整数至多有 $2(N-2)$ 个\myFN{也就是 $2$, $-2$, $3$, $-3$, $\cdots$, $N-1$, $-(N-1)$.}, 故我们可以用这 $2(N-2)$ 个整数一个一个地除, 以判断这样的 $f_1$, $f_2$ 是否存在. 因为 $g$ 是 $f$ 的因子的一个必要与充分条件是 $-g$ 是 $f$ 的因子, 故我们不必用负整数除 $f$; 也就是说, 用 $N-2$ 个整数 $2$, $3$, $\cdots$, $N-1$ 除 $f$ 就够了. 当然, 如果这 $N-2$ 个整数中有一个是 $f$ 的因子, 则 $f$ 是可约的; 我们可以停下来了.

\begin{example}
    设 $f = 17$. 则 $N = |f| = 17$. 我们用 $N-2=15$ 个整数 $2$, $3$, $\cdots$, $16$ 除 $f$. $2$ 不是 $f$ 的因子; $3$ 不是 $f$ 的因子……$16$ 不是 $f$ 的因子\myFN{感兴趣的读者可自行完成 $15$ 次带馀除法.}. 所以, $17$ 是不可约的. 当然, $-17$ 也是不可约的.
\end{example}

\begin{example}
    设 $f = 35$. 则 $N = |f| = 35$. 我们用 $N-2=33$ 个整数 $2$, $3$, $\cdots$, $34$ 除 $f$. $2$, $3$, $4$ 都不是 $f$ 的因子, 但 $5$ 是 $f$ 的因子. 所以, $f$ 是可约的. 我们看看 $5$. $5$ 是最小的高于 $1$ 的 $f$ 的因子. 读者可能也知道, $5$ 是不可约的.

    再看 $g = 49$. 则 $N = |g| = 49$. 我们用 $N-2=47$ 个整数 $2$, $3$, $\cdots$, $48$ 除 $g$. $2$, $3$, $4$, $5$, $6$ 都不是 $g$ 的因子, 但 $7$ 是 $f$ 的因子. 所以, $g$ 是可约的. 我们看看 $7$. $7$ 是最小的高于 $1$ 的 $h$ 的因子. 读者可能也知道, $7$ 是不可约的.
\end{example}

一般地, 我们有
\begin{proposition}
    设 $f$ 既不是 $0$, 也不是单位. 若 $p$ 是最小的高于 $1$ 的 $f$ 的因子, 则 $p$ 是不可约的.
\end{proposition}

\begin{pf}
    用反证法. 若 $p$ 是可约的, 则存在整数 $f_1, f_2$ 使 $p = f_1 f_2$, 且 $f_1$, $f_2$ 不是单位. 因为 $p$ 高于 $1$, 故可假定 $f_1$, $f_2$ 是正整数. 所以, $f_1$ 与 $f_2$ 也都高于 $1$. 所以
    \begin{align*}
        p - f_1 = f_1 f_2 - f_1 = f_1 (f_2 - 1) > 0.
    \end{align*}
    因为 $f_1$ 是 $p$ 的因子, 而 $p$ 是 $f$ 的因子, 故 $f_1$ 是 $f$ 的因子. 因为 $f_1 > 1$, 且 $f_1 < p$, 故 $p$ 不是最小的高于 $1$ 的 $f$ 的因子. 矛盾!
\end{pf}

\begin{remark}
    上面的命题表明: 若 $f$ 是可约的, 则 $2$, $3$, $\cdots$, $|f|-1$ 的首个 $f$ 的因子一定是不可约的. 这也是一种找不可约的整数的办法. 后面, 我们在讨论整数的因子分解时, 此命题将很有用.
\end{remark}

或许读者觉得试除法要太长时间了. 的确如此; 作者也这么认为. 若 $f$ 是可约的, 则我们不必试全部的 $|f| - 2$ 个整数; 可如果 $f$ 不是可约的, 那这太糟糕了——试了 $|f| - 2$ 次. 所以, 我们有必要简化试除法.

请读者先回忆一下算术平方根. 若 $t$ 是非负实数, 则存在唯一的非负实数 $s$ 适合 $s^2 = t$. 我们用 $\sqrt{t}$ 表示这个 $s$; $\sqrt{t}$ 就是 $t$ 的算术平方根\myFN{证明至多有一个这样的 $s$ 是容易的: 若非负实数 $s_1$, $s_2$ 的平方都是 $t$, 则 $0 = t - t = s_1^2 - s_2^2 = (s_1 - s_2)(s_1 + s_2)$. 若 $s_1 + s_2 = 0$, 则因 $s_1$, $s_2$ 是非负的, 必有 $s_1 = s_2 = 0$; 若 $s_1 + s_2 \neq 0$, 则必有 $s_1 - s_2 = 0$. 关键的问题是: 为什么这样的 $s$ 是存在的? 我们也知道, 任何有理数的平方都不可能等于 $3$; 为什么把 ``有理数'' 改为 ``实数'' 就有了呢? 这个问题的严格的讨论需要本文未曾介绍过的 (分析学的) 知识; 这些知识的讨论又可单独成册了.}. 比方说, $\sqrt{4} = 2$, $\sqrt{121} = 11$, $\sqrt{0} = 0$, $\sqrt{1} = 1$.

\begin{proposition}
    设 $f$ 是整数. 设整数 $f_1$, $f_2$ 适合 $f = f_1 f_2$. 设 $|f_1| \leq |f_2|$. 则 $|f_1| \leq \sqrt{|f|}$.
\end{proposition}

\begin{pf}
    用反证法. 若 $|f_1| > \sqrt{|f|}$, 则 $|f_2|$ 也高于 $\sqrt{|f|}$. 所以
    \begin{align*}
        |f| = |f_1| \cdot |f_2| > \sqrt{|f|} \cdot \sqrt{|f|} = |f|,
    \end{align*}
    矛盾!
\end{pf}

根据此命题, 我们在试除时, 不必从 $2$ 到 $N-2$ (这里 $N = |f|$), 只要用从 $2$ 到 $\sqrt{N}$ 的整数即可. 最大的且不超过 $\sqrt{N}$ 的整数是 $\left \lfloor \sqrt{N} \right \rfloor$. 所以, 试除法的 ``$N-2$ 个整数 $2$, $3$, $\cdots$, $N-1$'' 可改为 ``$\left \lfloor \sqrt{N} \right \rfloor - 1$ 个整数 $2$, $3$, $\cdots$, $\left \lfloor \sqrt{N} \right \rfloor - 1$''.

\begin{example}
    设 $f = 233$. 则 $N = |f| = 233$. 对人而言, $233$ 已经不算小了. 如果不进行任何优化, 我们需要用 $N-2 = 231$ 个整数除 $f$. 作者不知道读者怎么想; 作者肯定不愿意用 $231$ 个整数除 $f$. 所以, 我们用上面的花招简化一下.

    如果读者背诵过 ``小整数'' (绝对值不高于 $100$ 的整数) 的平方, 就会知道 $15^2 = 225$, $16^2 = 256$. 所以, 最大的且不超过 $\sqrt{233}$ 的整数就是 $15$. 我们用 $14$ 个整数 $2$, $3$, $\cdots$, $15$ 除 $f$. 从 $233$ 到 $14$, 这是很大的进步! 现在, 我们可以试除了. $14$ 次除法后, 可知: $2$, $3$, $\cdots$, $15$ 都不是 $f$ 的因子. 所以, $233$ 是不可约的.
\end{example}

事实上, 试除时, 我们可以只用不可约的整数试除. 这很明显. 若 $g$ 是可约的, 则存在不可约的整数 $p$ 使 $p$ 是 $g$ 的因子. 进一步, 我们可假定此 $p$ 是正整数. 若 $g$ 是 $f$ 的因子, 则 $p$ 当然也是 $f$ 的因子; 所以, 若 $p$ 不是 $f$ 的因子, 那么 $g$ 不可能是 $f$ 的因子.

不过, 不可约的整数应该往哪{\scriptsize 儿}找呢?

前面, 我们已看到: 任给不是 $\pm 2$, $\pm 3$ 的不可约的整数 $p$ ($4$ 当然是可约的: $4 = 2 \cdot 2$), 必有整数 $\ell$ 使 $p = 6\ell + 1$ 或 $p = 6\ell + 5$. 因为
\begin{align*}
    6\ell + 5 = 6\ell + 6 - 1 = 6(\ell + 1) - 1,
\end{align*}
故 $p$ 可写为 $6k \pm 1$, 其中 $k$ 是整数. 为方便, 无妨假定 $p$ 是正整数\myFN{若整数 $p$ 是不可约的, 则 $-p$ 也是不可约的. 试除时只需选正的整数, 故作者在此处 (为方便) 也选正的不可约的整数.}. 这样, $p \geq 5$. 由此可知 $6k \pm 1 \geq 5$, 即 $k \geq \frac{5 \mp 1}{6}$. 因为 $k$ 是整数, 故 $k \geq 1$. 换句话说, 我们证明了
\begin{proposition}
    设正整数 $p$ 是不可约的. 则 $p = 2$, 或 $p = 3$, 或存在正整数 $k$ 使 $p = 6k \pm 1$.
\end{proposition}

综上, 我们有如下的方法判断一个整数 $f$ (既不是单位, 也不是 $0$) 是否是不可约的:

(i) 置 $S = \left \lfloor \sqrt{|f|} \right \rfloor$.

(ii) 若 $2 > S$, 则 $f$ 是不可约的, 停止. 若 $2 \leq S$, 用 $2$ 除 $f$. 若 $2$ 是 $f$ 的因子, 则 $f$ 是可约的, 停止; 若 $2$ 不是 $f$ 的因子, 跳转到 (iii).

(iii) 若 $3 > S$, 则 $f$ 是不可约的, 停止. 若 $3 \leq S$, 用 $3$ 除 $f$. 若 $3$ 是 $f$ 的因子, 则 $f$ 是可约的, 停止; 若 $3$ 不是 $f$ 的因子, 跳转到 (iv).

(iv) 置 $p = 5$ (这相当于是令 $k = 1$, $p = 6k - 1$).

(v) 若 $p > S$, 则 $f$ 是不可约的, 停止. 若 $p \leq S$, 用 $p$ 除 $f$. 若 $p$ 是 $f$ 的因子, 则 $f$ 是可约的, 停止; 若 $p$ 不是 $f$ 的因子, 跳转到 (vi).

(vi) 将 $p$ 替换为 $p + 2$ (这相当于把 $p = 6k - 1$ 变为 $p = 6k + 1$).

(vii) 若 $p > S$ (这里的 $p$ 是新 $p$, 下同), 则 $f$ 是不可约的, 停止. 若 $p \leq S$, 用 $p$ 除 $f$. 若 $p$ 是 $f$ 的因子, 则 $f$ 是可约的, 停止; 若 $p$ 不是 $f$ 的因子, 跳转到 (viii).

(viii) 将 $p$ 替换为 $p + 4$ (这相当于把 $6k + 1$ 变为 $6k + 5 = 6(k+1) - 1$; 换句话说, 先把 $k$ 变为 $k+1$, 再把 $p$ 变为 $6k+1$). 跳转到 (v).

这个方法, 当然, 还是 ``试除法''. 而且, 上面的叙述相当 ``死板'': 初见此方法的读者可能不会立即理解此法是正确的. 此法适合丢给计算机, 让计算机判断一个 ``不太大的'' 整数\myFN{设 $t$ 是整数. 若 $t$ 不高于 $2^{31}-1$ 且 $t$ 不低于 $-2^{31}$, 则说 $t$ 是 ``不太大的''. 了解一点计算机知识的读者可看出, 这恰为 \texttt{int} (或 \texttt{int32}) ``数据类型'' 的 ``取值范围''.}是否是不可约的. 如果人在脑中 (或用纸笔) 作运算, 那么作者给个建议: 若 (v) (vii) 里的 $p$ 是可约的, 则跳过此步 (也就是所谓的 \texttt{continue}).

``光说不练, 假把式.'' 所以, 作者举一个例.

\begin{example}
    设 $f = 2\,333$. 则 $N = |f| = 2\,333$. 如果读者背诵过小整数的平方, 就会知道 $48^2 = 2\,304$, $49^2 = 2\,401$. 所以, $S = \left \lfloor \sqrt{N} \right \rfloor = 48$. 利用 ``$6k \pm 1$'', 我们只要用 $17$ 个整数 $2$, $3$, $5$, $7$, $11$, $13$, $17$, $19$, $23$, $25$, $29$, $31$, $35$, $37$, $41$, $43$, $47$ 除 $f$ ($49 > S$, 故我们不必考虑 $49$ 及其以后的整数). 事实上, 因为 $25 = 5 \cdot 5$, $35 = 5 \cdot 7$, 故 $25$ 与 $35$ 都是可约的; 这样, 我们可以划去这二个数——只剩 $15$ 个啦! 一个一个地除, 发现这 $15$ 个整数都不是 $f$ 的因子. 所以, $2\,333$ 是不可约的.
\end{example}

辛苦了! 请读者休息一会{\scriptsize 儿}.

\myLine

前面, 我们用试除法判断一个 (既不是 $0$, 也不是单位的) 整数是否是可约的. 现在, 我们考虑不等于非零整数的因子分解.

在正式地给出因子分解的定义前, 我们看一个例.

\begin{example}
    设 $f = 12$. 读者不难验证
    \begin{align*}
        f = 2 \cdot 2 \cdot 3.
    \end{align*}
    这是写 $f$ 为不可约的整数的积的一个结果. 为什么只是一个呢? 因为
    \begin{align*}
        f = (-2) \cdot (-2) \cdot 3,
    \end{align*}
    而 $-2$ 也是不可约的. 读者不至于认为 $-2$ 不是不可约的吧?

    当然了, 作者清楚, 读者更习惯正的不可约的整数; 作者知道, 负的不可约的整数看上去有些奇怪. 可是, $g = -12$ 该怎么写呢? 因为 $g = (-1)f$, 故一个自然的写法是
    \begin{align*}
        g = (-1) \cdot 2 \cdot 2 \cdot 3.
    \end{align*}
    不过, $-1$ 是单位, 故它既不是可约的, 也不是不可约的. 此时, 如果仍要写 $g$ 为不可约的整数的积, 读者不得不至少用一个负的不可约的整数:
    \begin{align*}
        g = 2 \cdot 2 \cdot (-3).
    \end{align*}
    此处, $-3$ 自然也是不可约的. 当然, 在这个特殊的例里, 读者也可以写
    \begin{align*}
        g = (-2) \cdot (-2) \cdot (-3).
    \end{align*}
    这里, 可写 $g$ 为负的不可约的整数的积. 不过 $-6$ 要怎么办? 读者不至于写 $-6 = (-2) \cdot (-3)$ 吧? 负负得正呀!
\end{example}

\begin{remark}
    读者应该意识到了上例暴露的 ``问题''. 怎么办呢, 读者朋友? 作者提供三个方案:

    (i) ``剥夺'' 负整数的 ``因子分解权''. 别笑! 虽然中国人很早 (1 世纪左右) 就开始玩负数了 (见《九章算术》的《方程》), 可是有的西方人 (主要是欧洲人) 怀疑负数 (据说, 到 19 世纪中期, 西方的算学家才普遍地接受负数). 法兰西算学家 Blaise Pascal 的朋友 Antoine Arnauld 如此质疑负数: 如果允许负数, 那么 $\frac{-1}{1} = \frac{1}{-1}$; 可是, 这说明小数 (较小的数, 下同) 与大数的比等于大数与小数的比, 矛盾!\myFN{如果这里的数都是正数, 那么小数与大数的比当然不是大数与小数的比; 可这里出现了负数. 如果读者还有印象, 就会记得, 不等式二侧同乘负数, 不等式反向. 或许此事实有助于解释此 ``怪事''.} 西方人接受 $0$ 的过程也是漫长的 (感兴趣的读者可自行查阅相关资料), 更别提负数了. 所以, 早期西方人研究 ``因数'' ``最大公因数'' ``素数'' 时, 这些数至少都是非负的. 所以 ``素数'' 一般都是指正的不可约的整数. 在研究不可约的整数的 ``高级性质'' 时, 为方便, 算学家往往要求它是正的; 这算是历史习惯了. 作者并没有说这个习惯不好; 事实上, 有时, 为方便, 作者自己也用 ``素数''.\myFN{既然作者说这么多了, 那么作者解释一下作者为什么讨论 ``整数的一些性质'' 而不是 ``非负整数的一些性质'' 吧. 在整数里, 我们可自由地加、减、乘; 类似地, 整式也可自由地被加、减、乘. 整数与整式都有带馀除法; 整数与整式都有用来求最大公因子的辗转相除法……作者在此就不重复整数与整式的大量的共同点了. 我们再看非负整数. 非负整数可加、乘, 但不一定能减 (小数减大数 ``不够减''). 在同人作里, 作者先讨论整数, 再讨论整式. 如果负数还能通过只考虑非整数避开 (毕竟, 因子可正可负), 那整式呢? 只考虑 $0$ 与首项系数为 $1$ 的整式吗 (毕竟, 二个非零整式的首项系数为 $1$ 的最大公因子恰有一个; 这跟二个非零整数的正的最大公因子恰有一个类似)? 当然可以; 不过, 没有必要: 借助 ``单位'' ``相伴'' 的概念, 我们克服了这个小问题.}

    (ii) 忽视这个问题, 且不限定不可约的整数的正负. 当然可以; 毕竟, 作者一开始可没说不可约的整数一定是正的. 不过, 有一点小问题. 为方便, 我们往往会把相伴的整数化为同一个. 比方说, 我们往往不写 $-12 = (-2) \cdot 2 \cdot 3$, 而是写 $-12 = 2 \cdot 2 \cdot (-3)$. 可是, $-9$ 要怎么办呢? 要么写 $3 \cdot (-3)$, 要么写 $(-3) \cdot 3$; 毕竟, 负负得正. 当然, 我们可以无视这一点: 相伴的整数可以不化为同一个.

    (iii) 跳出 ``不可约的整数的积'' 的 ``舒适圈'' \term{comfort zone}. 假如我们允许单位, 那么每个非零整数都可以写为 (至多) 一个单位与有限多个不可约的整数的积. 这很好理解: 单位自然是 ``一个单位与零个不可约的整数的积 (我们约定, 零个数的积是 $1$; 这跟零个数的和是 $0$ 类似)''; 既不是 $0$, 也不是单位的整数自然是 ``零个单位 (也可以是一个: $1$) 与有限多个 (至少有 $1$ 个) 不可约的整数的积''. 而且, 相伴的整数一定可被化为同一个. 若 $q$ 与 $p$ 相伴, 则有单位 $\varepsilon$ 使 $q = \varepsilon p$, 则 $pq = \varepsilon (pp)$. 因为乘法可交换、结合, 故我们可把多个单位都写在最前; 因为有限多个单位的积还是单位, 故多个单位可被写为一个单位. 具体地, $-9 = 3 \cdot (-3) = 3 \cdot (-1) \cdot 3 = (-1) \cdot 3 \cdot 3$ (当然, 也可以是 $-9 = (-1) \cdot (-3) \cdot (-3)$).
\end{remark}

在这里, 作者选用方案 (iii). 毕竟, 如果允许单位, 读者可自由地改变不可约的整数的形式, 直到其适合读者的口味为止. 所以, 相应地, 作者给出
\begin{definition}
    设整数 $f \neq 0$. 那么, $f$ 一定可写为 (至多一个) 单位与有限多个 (可以是零个) 不可约的整数的积, 即: 存在单位 $\varepsilon$ 与不可约的整数 $p_1$, $p_2$, $\cdots$, $p_s$ ($s$ 可为 $0$; 此时, $f$ 是单位) 使
    \begin{align*}
        f = \varepsilon p_1 p_2 \cdots p_s.
    \end{align*}
    上式右侧即为 $f$ 的因子分解 \term{factorization of $f$}. 动词短语 ``写 $f$ 为单位与有限多个不可约的整数的积'' 的一个简单的称呼是 ``因子分解 $f$'' \term{to factorize $f$}.
\end{definition}

\begin{remark}
    有时, 为书写方便, 允许在因子分解里出现幂. 读者不难看出, $2\,000 = 2 \cdot 2 \cdot 2 \cdot 2 \cdot 5 \cdot 5 \cdot 5$. 我们可将此式写为 $2\,000 = 2^4 \cdot 5^3$. 此时, 我们视 $2^4$ (或 $5^3$) 为 $4$ 个 $2$ 的积 (或 $3$ 个 $5$ 的积), 而不是一个不可约的整数!
\end{remark}

作为一个挑战, 作者邀请读者从下面的例中自行提炼出因子分解整数的方法.

\begin{example}
    设 $f = -83\,143$. 这里, 作者用负整数举例. 还是老样子, $f$ 的绝对值 $N = 83\,143$. 我们看 $f$ 是否是可约的. 因为 $28^2 = 784$, $29^2 = 841$, 故 $280 < \sqrt{N} < 290$.\myFN{设 $a$, $b$ 是非负实数. 若 $a^2 < b^2$, 则 $a < b$; 若 $a < b$, 则 $a^2 < b^2$. 证明也很容易: $a^2 - b^2 = (a-b)(a+b)$.} 我们看看 $285^2$ ($285$ 恰好是 $280$ 与 $290$ 的和的一半):
    \begin{align*}
        285^2 = (280 + 5)^2 = 280^2 + 2\,800 + 25 = 81\,225 < N.
    \end{align*}
    所以 $285 < \sqrt{N} < 290$. 我们看 $287^2$ 与 $288^2$ ($287$ 或 $288$ 当然不是 $285$ 与 $290$ 的和的一半, $287.5$; 为避开小数的运算, 我们同时算离 $287.5$ 最近的二个整数的平方):
    \begin{align*}
         & 287^2 = (285 + 2)^2 = 285^2 + 570 \cdot 2 + 4 = 82\,369 < N, \\
         & 288^2 = (290 - 2)^2 = 290^2 - 580 \cdot 2 + 4 = 82\,944 < N.
    \end{align*}
    所以 $288 < \sqrt{N} < 290$. 我们看 $289^2$:
    \begin{align*}
        289^2 = (290 - 1)^2 = 290^2 - 580 + 1 = 83\,521 > N.
    \end{align*}
    所以 $288 < \sqrt{N} < 289$. 也就是说, $S = \left \lfloor \sqrt{N} \right \rfloor = 288$. 当然, 有计算器 (计算机) 的读者可直接算 $\sqrt{N}$, 从而得 $S$.

    现在我们可以用不超过 $S$ 的 $2$, $3$, $5$, $7$, $\cdots$, $6k-1$, $6k+1$, $\cdots$ 除 $f$. 有一点值得读者注意: 从绝对值小的到绝对值大的, 一个一个地试. 我们作一个 ``空盒子'' $B$. 此 $B$ 的作用是: 存放不是 $f$ 的因子的 (被用来试除 $f$ 的) 数. 比方说, $2$, $3$, $5$, $7$ 都不是 $f$ 的因子, 故我们依次把 $2$, $3$, $5$, $7$ 丢入 $B$. 类似地, $11$, $13$, $17$, $19$, $23$ 都被丢入 $B$. $25$ 呢? 老朋友了——$25 = 5 \cdot 5$, 故我们不必除, 直接舍弃 (也不必放入 $B$). 当然, 若读者没认出可约的 $25$, 也没有任何影响. 这里, 为了不过多地让小细节影响读者, 我们假装用 $25$ 除 $f$, 且发现 $25$ 不是 $f$ 的因子, 故 $25$ 被丢入 $B$. 下一个数是 $29$. 好! $f = 29 \cdot (-2\,867)$. 所以, $f$ 是可约的. (提醒一下读者: 现在不要把 $29$ 丢入 $B$. 为什么呢? $B$ 存放不是 $f$ 的因子的数. $29$ 是 $f$ 的因子, 所以我们不把 $29$ 放入 $B$ 里.)

    不过, 我们的任务是因子分解 $f$. $g = -2\,867$ 是不是可约的? 我们还不知道呢. 不过, 根据前面的讨论, 既然 $29$ 是最小的高于 $1$ 的 $f$ 的因子, 那么 $29$ 本身是不可约的 (这就是让读者从绝对值小的到绝对值大的, 一个一个地试的理由). 我们继续研究 $g$. 设 $g = \varepsilon p_2 p_3 \cdots p_s$, 其中 $\varepsilon$ 是单位, $p_2$, $p_3$, $\cdots$, $p_s$ 是 $s-1$ 个不可约的整数. 把这个结果跟 $f = 29g$ 合并, 就得到了 $f$ 的因子分解, 对不 ($29$ 是不可约的!)?

    继续. 我们看 $g = -2\,867$. $g$ 的绝对值 $N^{\prime} = 2\,867$. 背过小整数的平方的读者可能知道, $53^2 = 2\,809$, $54^2 = 2\,916$, 故 $S^{\prime} = \left \lfloor \sqrt{N^{\prime}} \right \rfloor = 53$. 所以, 我们只需用不超过 $S^{\prime}$ 的 $2$, $3$, $5$, $7$, $\cdots$, $6k-1$, $6k+1$, $\cdots$ 除 $g$. 跟前面类似, 还是从绝对值小的到绝对值大的, 一个一个地试. 我们也作一个新的 ``空盒子'' $B^{\prime}$.

    又有一点值得读者留意. 前面的 $B$ 的数一定不是 $g$ 的因子. 为什么? 用反证法. 假如 $B$ 里有个 ``坏'' $b$ 是 $g$ 的因子. 因为 $g$ 是 $f$ 的因子, 故 $b$ 也是 $f$ 的因子. 可是, $b$ 为什么在 $B$ 里? 因为 $b$ 不是 $f$ 的因子, 我们才把 $b$ 放入 $B$ 的, 是不? 矛盾! 所以, 我们把 $B$ 里的数 $2$, $3$, $5$, $7$, $11$, $13$, $17$, $19$, $23$, $25$ (注意: 没有 $29$) 都丢入 $B^{\prime}$. 这仿佛开加速器了, 是不?

    这样, 我们从 $29$ 开始. 不过这一次, $29$ 不是 $g$ 的因子了. 所以我们把 $29$ 丢入 $B^{\prime}$. 类似地, $31$, $35$ (跟 $25$ 一样, 假装不知道 $35$ 是可约的), $37$, $41$, $43$ 都被丢入 $B^{\prime}$. $47$ 是 $g$ 的因子: $g = 47 \cdot (-61)$. 所以, $g$ 仍为可约的. 老样子, 既然 $47$ 是最小的高于 $1$ 的 $g$ 的因子, 那么 $47$ 本身是不可约的.

    我们还剩下 $h = -61$. 它是可约的吗? $N^{\prime \prime} = |h| = 61$, $S^{\prime \prime} = \left \lfloor \sqrt{N^{\prime \prime}} \right \rfloor = 7$. 类似地, $B^{\prime}$ 里的数都不是 $h$ 的因子. 所以, 没数可试了. 所以, $h$ 是不可约的.

    综上, 我们可将 $f$ 写为 $29 \cdot 47 \cdot (-61)$. 如果读者不想看到负的不可约的整数, 读者可写 $f$ 为 $(-1) \cdot 29 \cdot 47 \cdot 61$. 这里, 读者应该能体会到允许一个单位是有用的: 至少 ``好看了''. 当然, 读者也可写 $f$ 为 $(-29) \cdot (-47) \cdot (-61)$: 单位 $1$ 不必显明地写出来了.
\end{example}

\begin{remark}
    作者还是提醒一下读者: 若整数 $f$ ``太大了'', 则此法就不好用了. 读者完全可以用计算机因子分解不太大的整数; 作者在本文里给的方法适合人在脑中 (或用纸笔) 作运算. 读者可自行了解有关太大的整数的因子分解的资料 (事实上, 挺复杂的). 如果读者是蟒蛇 \term{Python} 玩家, 可体验这里的因子分解程序:
    \begin{align*}
        \texttt{https://zhuanlan.zhihu.com/p/389061210}
    \end{align*}
\end{remark}

感谢读者读到这里. 请读者休息一下, 并试着作出 ``因子分解整数的技术总结''.

\myLine

我们还剩下一个小任务: 找整数 $f$ 的所有因子.

常言道, $0$ 的因子是任意的整数, 而单位的因子只能是单位. 这二位是老朋友了; 我们不必多言.

或许读者还能记起
\begin{proposition}
    设整数 $f$ 既不是 $0$, 也不是单位. 设 $p_1$, $p_2$, $\cdots$, $p_m$ 是不可约的整数, 且
    \begin{align*}
        f = p_1 p_2 \cdots p_m.
    \end{align*}
    $f$ 的因子必为
    \begin{align*}
        \varepsilon p_{j_1} p_{j_2} \cdots p_{j_s},
    \end{align*}
    其中 $\varepsilon$ 是单位, $j_1$, $j_2$, $\cdots$, $j_s$ 是 $1$, $2$, $\cdots$, $m$ 中 $s$ 个不同的数 ($s$ 可取 $0$; 此时, 这就是单位).
\end{proposition}

所以, 如果我们有 $f$ 的因子分解, 我们就能立即写出 $f$ 的所有因子.

为方便读者应用, 作者给出此命题的一个变体.

\begin{proposition}
    设整数 $f \neq 0$. 设 $\varepsilon$ 是单位, $p_1$, $p_2$, $\cdots$, $p_m$ 是不可约的整数 ($m$ 可取 $0$; 此时, $f$ 是单位), 且
    \begin{align*}
        f = \varepsilon p_1 p_2 \cdots p_m.
    \end{align*}
    $f$ 的因子必为
    \begin{align*}
        \varepsilon^{\prime} p_{j_1} p_{j_2} \cdots p_{j_s} \tag*{(\ding{72})},
    \end{align*}
    其中 $\varepsilon^{\prime}$ 是单位, $j_1$, $j_2$, $\cdots$, $j_s$ 是 $1$, $2$, $\cdots$, $m$ 中 $s$ 个不同的数 ($s$ 可取 $0$; 此时, 这就是单位).
\end{proposition}

\begin{pf}
    若 $f$ 是单位, 则 $m = 0$. 此时我们无法从 $m$ 个数 $1$, $2$, $\cdots$, $m$ 中 ``取出'' 数, 故 $s = 0$. 所以 (\ding{72}) 变为单位——这恰为 $f$ 的因子.

    若 $f$ 既不是 $0$, 也不是单位, 则
    \begin{align*}
        g = \varepsilon^{-1} f = p_1 p_2 \cdots p_m
    \end{align*}
    既不是 $0$, 也不是单位 (如果读者不能理解这一点, 读者可用反证法). 因为 $f$ 与 $g$ 相伴, 故 $g$ 的因子都是 $f$ 的因子, 且 $f$ 的因子都是 $g$ 的因子 (如果读者不能理解这一点, 读者可设 $d$ 是 $f$ 的因子, 则因 $f$ 是 $g$ 的因子, 故 $d$ 也是 $g$ 的因子; 反过来也是类似的). 这样, 既然 $g$ 的因子都形如 (\ding{72}) (可直接套用上命题于 $g$), 那么 $f$ 的因子也都形如 (\ding{72}).
\end{pf}

作者给一个建议. $f$ 的因子分解里, 可能会有相伴的不可约的整数. 最好将相伴的整数化为相同的整数 (顶多差一个单位罢了); 否则, 得到的结果不会特别好看.

作者举二个例.

\begin{example}
    设 $f = 60$. 我们知道
    \begin{align*}
        60 = 2 \cdot 2 \cdot 3 \cdot 5.
    \end{align*}
    所以, $f$ 的因子有
    \begin{align*}
         & \varepsilon;                                                                                                                                    \\ \displaybreak[3]
         & 2\varepsilon, 2\varepsilon, 3\varepsilon, 5\varepsilon;                                                                                         \\ \displaybreak[3]
         & (2 \cdot 2)\varepsilon, (2 \cdot 3)\varepsilon, (2 \cdot 5)\varepsilon, (2 \cdot 3)\varepsilon, (2 \cdot 5)\varepsilon, (3 \cdot 5)\varepsilon; \\ \displaybreak[3]
         & (2 \cdot 2 \cdot 3)\varepsilon, (2 \cdot 2 \cdot 5)\varepsilon, (2 \cdot 3 \cdot 5)\varepsilon, (2 \cdot 3 \cdot 5)\varepsilon;                 \\ \displaybreak[3]
         & (2 \cdot 2 \cdot 3 \cdot 5)\varepsilon.
    \end{align*}
    这里, $\varepsilon$ 取遍所有单位 ($1$ 与 $-1$). 将上面的式化简、去重, 有
    \begin{align*}
         & \varepsilon;                                              \\ \displaybreak[3]
         & 2\varepsilon, 3\varepsilon, 5\varepsilon;                 \\ \displaybreak[3]
         & 4\varepsilon, 6\varepsilon, 10\varepsilon, 15\varepsilon; \\ \displaybreak[3]
         & 12\varepsilon, 20\varepsilon, 30\varepsilon;              \\ \displaybreak[3]
         & 60\varepsilon.
    \end{align*}
    由此可见, $f$ 有 $2 \cdot 12$ 个因子.

    当然, 读者可能想用这个因子分解求 $f$ 的所有因子:
    \begin{align*}
        f = (-2) \cdot 2 \cdot (-3) \cdot 5.
    \end{align*}
    这里, $-2$ 与 $2$ 相伴, 但未被化为同一个. $f$ 的因子有
    \begin{align*}
         & \varepsilon;                                                                                                                                                \\ \displaybreak[3]
         & -2\varepsilon, 2\varepsilon, -3\varepsilon, 5\varepsilon;                                                                                                   \\ \displaybreak[3]
         & (-2 \cdot 2)\varepsilon, (-2 \cdot (-3))\varepsilon, (-2 \cdot 5)\varepsilon, (2 \cdot (-3))\varepsilon, (2 \cdot 5)\varepsilon, ((-3) \cdot 5)\varepsilon; \\ \displaybreak[3]
         & (-2 \cdot 2 \cdot (-3))\varepsilon, (-2 \cdot 2 \cdot 5)\varepsilon, (-2 \cdot (-3) \cdot 5)\varepsilon, (2 \cdot (-3) \cdot 5)\varepsilon;                 \\ \displaybreak[3]
         & (-2 \cdot 2 \cdot (-3) \cdot 5)\varepsilon.
    \end{align*}
    还是老样子, $\varepsilon$ 取遍所有的单位. 将上面的式化简、去重, 有
    \begin{align*}
         & \varepsilon;                                                                               \\ \displaybreak[3]
         & -2\varepsilon, 2\varepsilon, 3\varepsilon, 5\varepsilon;                                   \\ \displaybreak[3]
         & -4\varepsilon, 6\varepsilon, -10\varepsilon, -6\varepsilon, 10\varepsilon, -15\varepsilon; \\ \displaybreak[3]
         & 12\varepsilon, -20\varepsilon, 30\varepsilon, -30\varepsilon;                              \\ \displaybreak[3]
         & 60\varepsilon.
    \end{align*}
    粗看这些式, 读者可能会觉得 $f$ 有 $2 \cdot 16$ 个因子. 其实并不是. 显然, $-2\varepsilon$ 与 $2\varepsilon$ 相伴; $6\varepsilon$ 与 $-6\varepsilon$ 相伴; $-10\varepsilon$ 与 $10\varepsilon$ 相伴; $30\varepsilon$ 与 $-30\varepsilon$ 相伴. 这里有 $4$ 组相伴元, 每组有 $2$ 个. 我们从每组里选一个代表. 这样, 我们去除了 $8 - 4 = 4$ 个式. 所以, $f$ 应有 $2 \cdot (16 - (8 - 4))$ 个因子.
\end{example}

\begin{example}
    设 $f = -83\,143$. 我们知道
    \begin{align*}
        f = 29 \cdot 47 \cdot (-61).
    \end{align*}
    所以, $f$ 的因子有
    \begin{align*}
         & \varepsilon;                                                                        \\ \displaybreak[3]
         & 29\varepsilon, 47\varepsilon, -61\varepsilon;                                       \\ \displaybreak[3]
         & (29 \cdot 47)\varepsilon, (29 \cdot (-61))\varepsilon, (47 \cdot (-61))\varepsilon; \\ \displaybreak[3]
         & (29 \cdot 47 \cdot (-61))\varepsilon.
    \end{align*}
    还是老样子, $\varepsilon$ 取遍所有的单位. 将上面的式化简、去重, 有
    \begin{align*}
         & \varepsilon;                                               \\ \displaybreak[3]
         & 29\varepsilon, 47\varepsilon, -61\varepsilon;              \\ \displaybreak[3]
         & 1\,363\varepsilon, -1\,769\varepsilon, -2\,867\varepsilon; \\ \displaybreak[3]
         & -83\,143\varepsilon.
    \end{align*}
    由此可见, $f$ 有 $2 \cdot 8$ 个因子.
\end{example}

一般地, $f$ 的因子的数目有如下规律.

\begin{proposition}
    设整数 $f \neq 0$. 设 $f$ 的因子分解为
    \begin{align*}
        \varepsilon p_1 p_2 \cdots p_m,
    \end{align*}
    其中 $\varepsilon$ 是单位, $p_1$, $p_2$, $\cdots$, $p_m$ 是不可约的整数 ($m$ 可取 $0$). 将相伴的整数化为同一个, 可得
    \begin{align*}
        f = \varepsilon^{\prime} q_1^{r_1} q_2^{r_2} \cdots q_s^{r_s},
    \end{align*}
    其中 $\varepsilon^{\prime}$ 是单位, $q_1$, $q_2$, $\cdots$, $q_s$ 是互不相伴的不可约的整数 (亦即: 不可约的整数 $q_1$, $q_2$, $\cdots$, $q_s$ PRP), $r_1$, $r_2$, $\cdots$, $r_s$ 是正整数. ($s$ 亦可取 $0$.) 则 $f$ 至多有
    \begin{align*}
        n = (1 + r_1) (1 + r_2) \cdots (1 + r_s)
    \end{align*}
    个互不相伴的因子. 因为整数恰有二个单位, 故 $f$ 有 $2n$ 个因子.
\end{proposition}

\begin{pf}
    首先我们说明, $f$ 的因子一定形如
    \begin{align*}
        \varepsilon^{\prime \prime} q_1^{t_1} q_2^{t_2} \cdots q_s^{t_s}, \tag*{(\ding{72})}
    \end{align*}
    其中 $\varepsilon^{\prime \prime}$ 是单位, $t_i$ 是不高于 $r_i$ 的非负整数 ($i = 1$, $2$, $\cdots$, $s$). 显然, (\ding{72}) 是 $f$ 的因子:
    \begin{align*}
        f = \left(\varepsilon^{\prime \prime} q_1^{t_1} q_2^{t_2} \cdots q_s^{t_s}\right) \left((\varepsilon^{\prime \prime})^{-1} \varepsilon^{\prime} q_1^{r_1 - t_1} q_2^{r_2 - t_2} \cdots q_s^{r_s - t_s}\right).
    \end{align*}
    现在, 我们要说明, $f$ 的因子可写为 (\ding{72}) 的形式. 我们已经知道, $f$ 的因子一定形如
    \begin{align*}
        g = \varepsilon^{\prime \prime \prime} p_{j_1} p_{j_2} \cdots p_{j_u},
    \end{align*}
    其中 $\varepsilon^{\prime \prime \prime}$ 是单位, $j_1$, $j_2$, $\cdots$, $j_u$ 是 $1$, $2$, $\cdots$, $m$ 中 $u$ 个不同的数. 既然每个 $p_i$ 都能写为 $\varepsilon_i q_{v_i}$ ($v_i$ 是 $1$, $2$, $\cdots$, $s$ 的某个数), 那么每个 $p_{j_i}$ 都能写为 $\varepsilon_{j_i} q_{v_{j_i}}$. 将所有的单位写在一块{\scriptsize 儿}, 再把多个 $q_{v_{j_i}}$ 写为 $q_{v_{j_i}}$ 的幂, 就有
    \begin{align*}
        g = \delta q_{k_1}^{w_1} q_{k_2}^{w_2} \cdots q_{k_\ell}^{w_\ell},
    \end{align*}
    其中 $\delta$ 是单位, $k_1$, $k_2$, $\cdots$, $k_\ell$ 是 $1$, $2$, $\cdots$, $s$ 中不同的 $\ell$ 个数, $w_1$, $w_2$, $\cdots$, $w_\ell$ 都是正整数. 我们说明: $w_i$ 不超过 $r_{k_i}$. 用反证法. 若 $w_i > r_{k_i}$, 则因 $q_{k_i}^{w_i}$ 是 $g$ 的因子, 且 $g$ 是 $f$ 的因子, 故 $q_{k_i}^{w_i}$ 是 $f$ 的因子. 也就是说, 有整数 $F$ 使
    \begin{align*}
        q_{k_i}^{w_i-r_{k_i}} q_{k_i}^{r_{k_i}} F = \varepsilon^{\prime} q_1^{r_1} q_2^{r_2} \cdots q_s^{r_s}.
    \end{align*}
    因 $q_{k_i} \neq 0$, 故
    \begin{align*}
        q_{k_i}^{w_i-r_{k_i}} F = \varepsilon^{\prime} q_1^{r_1} \cdots q_{k_i - 1}^{r_{k_i - 1}} q_{k_i + 1}^{r_{k_i + 1}} \cdots q_s^{r_s}.
    \end{align*}
    因为 $w_i > r_{k_i}$, 故 $q_{k_i}$ 仍为上式左侧的因子; 这样, $q_{k_i}$ 也是上式右侧的因子. 因为 $q_{k_i}$ 是不可约的, 所以 $q_{k_i}$ 一定是 $q_1^{r_1}$, $\cdots$, $q_{k_i - 1}^{r_{k_i - 1}}$, $q_{k_i + 1}^{r_{k_i + 1}}$, $\cdots$, $q_s^{r_s}$ (此处无 $q_{k_i}$ 的幂!) 这 $s-1$ 个整数中的某一个 (不要求恰有一个) 的因子. 设 $q_{k_i}$ 是 $q_\alpha^{r_\alpha}$ ($r_\alpha \neq k_i$) 的因子. 类似地, 把幂写为 $r_\alpha$ 个 $q_\alpha$ 的积, 即知 $q_{k_i}$ 是 $q_\alpha$ 的因子. 所以 $q_{k_i}$ 与 $q_\alpha$ 不互素. 所以 $q_{k_i}$ 与 $q_\alpha$ 相伴! 矛盾.

    由上述讨论, 知: 每个 $w_i$ 不超过 $r_{k_i}$. $q_{k_1}$, $q_{k_2}$, $\cdots$, $q_{k_\ell}$ 可能不能包含 $q_1$, $q_2$, $\cdots$, $q_s$; 如果这样, 就把缺的 $q_i$ 用 $1 = q_i^0$ 补上. 综上, $f$ 的每一个因子都可写为 (\ding{72}) 的形式.

    设
    \begin{align*}
         & f_1 = \varepsilon_1 q_1^{t_{1,1}} q_2^{t_{1,2}} \cdots q_s^{t_{1,s}}, \\
         & f_2 = \varepsilon_2 q_1^{t_{2,1}} q_2^{t_{2,2}} \cdots q_s^{t_{2,s}}.
    \end{align*}
    这里, $\varepsilon_1$ 与 $\varepsilon_2$ 都是单位, $t_{1,1}$, $t_{2,1}$, $t_{1,2}$, $t_{2,2}$, $\cdots$, $t_{1,s}$, $t_{2,s}$ 是 $2s$ 个非负整数; $q_1$, $q_2$, $\cdots$, $q_s$ 自然还是互不相伴的不可约的整数. 我们证明, $f_1$ 与 $f_2$ 相伴的一个必要与充分条件是
    \begin{align*}
        t_{1,i} = t_{2,i}, \quad i = 1,2,\cdots,s.
    \end{align*}
    充分性很容易. 既然 $t_{1,i} = t_{2,i}$, 那么
    \begin{align*}
        \varepsilon_1^{-1} f_1 = \varepsilon_2^{-1} f_2.
    \end{align*}
    由此, 读者在脑中将上式同乘 $\varepsilon_1$, 可知 $f_1$ 与 $f_2$ 相伴. 有点复杂的是必要性. 设 $f_1$ 与 $f_2$ 相伴. 我们先固定 $i$, 然后再证 $t_{1,i} = t_{2,i}$. 既然 $f_1$ 与 $f_2$ 相伴, 那么存在单位 $\delta$ 使
    \begin{align*}
        \varepsilon_1 q_i^{t_{1,i}} \underbrace{\left(q_1^{t_{1,1}} \cdots q_{i-1}^{t_{1,i-1}} q_{i+1}^{t_{1,i+1}} \cdots q_s^{t_{1,s}}\right)}_{F_1} = \delta \varepsilon_2 q_i^{t_{2,i}} \underbrace{\left(q_1^{t_{2,1}} \cdots q_{i-1}^{t_{2,i-1}} q_{i+1}^{t_{2,i+1}} \cdots q_s^{t_{2,s}}\right)}_{F_2}.
    \end{align*}
    稍作整理, 就有
    \begin{align*}
        \varepsilon_1 q_i^{t_{1,i}} F_1 = (\delta \varepsilon_2) q_i^{t_{2,i}} F_2.
    \end{align*}
    我们用反证法证明 $t_{1,i} = t_{2,i}$. 假定 $t_{1,i} > t_{2,i}$. 这样
    \begin{align*}
        (\varepsilon_1 \delta^{-1} \varepsilon_2^{-1}) q_i^{t_{1,i} - t_{2,i}} F_1 = F_2.
    \end{align*}
    既然 $t_{1,i} > t_{2,i}$, 那么 $q_i$ 是上式左侧的因子. 所以, $q_i$ 也是上式右侧 (即 $F_2$) 的因子. 因为
    \begin{align*}
        F_2 = q_1^{t_{2,1}} \cdots q_{i-1}^{t_{2,i-1}} q_{i+1}^{t_{2,i+1}} \cdots q_s^{t_{2,s}},
    \end{align*}
    且 $q_i$ 是不可约的, 故 $q_i$ 是 $q_1^{t_{1,1}}$, $\cdots$, $q_{i-1}^{t_{2,i-1}}$, $q_{i+1}^{t_{2,i+1}}$, $\cdots$, $q_s^{t_{2,s}}$ (此处无 $q_i$ 的幂!) 这 $s-1$ 个数中的某一个 (不要求恰有一个) 的因子. 设 $q_i$ 是 $q_\alpha^{t_{2,\alpha}}$ ($i \neq \alpha$) 的因子. 类似地, 把幂写为 $t_{2,\alpha}$ 个 $q_\alpha$ 的积, 即知 $q_i$ 是 $q_\alpha$ 的因子. 所以 $q_i$ 与 $q_\alpha$ 不互素. 所以 $q_i$ 与 $q_\alpha$ 相伴! 矛盾. 类似地, 若假定 $t_{1,i} < t_{2,i}$, 也可导出矛盾.

    上段文字说明: 在 (\ding{72}) 里, 不同的 $t_1$, $t_2$, $\cdots$, $t_s$ 给出不相伴的整数. 所以, 为计算 $f$ 至多有多少个互不相伴的因子, 我们只要计算有多少 $t_1$, $t_2$, $\cdots$, $t_s$ 适合条件 $0 \leq t_i \leq r_i$ 且 $t_i$ 为整数即可. 显然, 每个 $t_i$ 有 $1 + r_i$ 种取值 ($0$, $1$, $\cdots$, $r_i$), 且 $t_i$ 的取值与 $t_j$ 的取值是互不影响的 ($i \neq j$). 根据乘法原理, 这样的 $t_1$, $t_2$, $\cdots$, $t_s$ 的数目为
    \begin{align*}
        n = (1 + r_1) (1 + r_2) \cdots (1 + r_s).
    \end{align*}

    最后, 因为整数恰有二个单位 $1$ 与 $-1$, 故 $f$ 的所有的因子的数目是 $n \cdot 2 = 2n$.
\end{pf}

\begin{example}
    再谈前面的二个例. 因为 $60 = 2^2 \cdot 3 \cdot 5$, 故 $60$ 有 $(1+2) \cdot (1+1) \cdot (1+1) = 12$ 个互不相伴的因子. $60$ 的全部的因子的数目是 $24 = 12 \cdot 2$. 同理, 因为 $-83\,143 = 29 \cdot 47 \cdot (-61)$, 故 $-83\,143$ 有 $(1+1) \cdot (1+1) \cdot (1+1) = 8$ 个互不相伴的因子. $-83\,143$ 的全部的因子的数目是 $16 = 8 \cdot 2$.
\end{example}

由上个命题的证明, 我们提取出
\begin{proposition}
    设整数 $f \neq 0$. 设 $\varepsilon$ 是单位, $q_1$, $q_2$, $\cdots$, $q_s$ 是互不相伴的不可约的整数 ($s$ 可取 $0$; 此时, $f$ 是单位), $r_1$, $r_2$, $\cdots$, $r_s$ 是正整数, 且
    \begin{align*}
        f = \varepsilon q_1^{r_1} q_2^{r_2} \cdots q_s^{r_s}.
    \end{align*}
    则 $f$ 的因子一定形如
    \begin{align*}
        \varepsilon^{\prime} q_1^{t_1} q_2^{t_2} \cdots q_s^{t_s},
    \end{align*}
    其中 $\varepsilon^{\prime}$ 是单位, $t_i$ 是不高于 $r_i$ 的非负整数 ($i=1$, $2$, $\cdots$, $s$).
\end{proposition}

我们以一个简单的例结束本文.

\begin{example}
    设 $f = -392$. 因为 $f = 8 - 400$, 而 $400 = 8 \cdot 50$, 故 $f = 8 \cdot (1 - 50) = 8 \cdot (-49)$. 又因为 $-49 = (-1) \cdot 7 \cdot 7$, 故
    \begin{align*}
        f = (-1) \cdot 2^3 \cdot 7^2.
    \end{align*}
    读者不难验证, $2$ 与 $7$ 都是不可约的, 且 $2$ 与 $7$ 不相伴. 所以, $f$ 的因子的数目为
    \begin{align*}
        2 \cdot (1+3) \cdot (1+2) = 24.
    \end{align*}
    $f$ 的因子是 $\varepsilon^{\prime} 2^{t_1} 7^{t_2}$, 其中 $\varepsilon^{\prime}$ 是单位, $t_1$ 取 $0$ 至 $3$ 间的整数, $t_2$ 取 $0$ 至 $2$ 间的整数. 由此不难写出 $f$ 的因子:
    \begin{align*}
         & {\pm 1};                     \\ \displaybreak[3]
         & {\pm 2}, {\pm 7};            \\ \displaybreak[3]
         & {\pm 4}, {\pm 14}, {\pm 49}; \\ \displaybreak[3]
         & {\pm 8}, {\pm 28}, {\pm 98}; \\ \displaybreak[3]
         & {\pm 56}, {\pm 196};         \\ \displaybreak[3]
         & {\pm 392}.
    \end{align*}
\end{example}

本文就到这里了. 感谢读者的阅读!
