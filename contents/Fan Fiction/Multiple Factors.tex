\subsection*{\MultipleFactors}
\addcontentsline{toc}{subsection}{\MultipleFactors}
\markright{\MultipleFactors}

本文将为读者介绍整式的重因子.

还是老样子: ``数'' 一定是复数 (或实数、有理数); ``整式'' 的系数一定是数.

在正式进入本文的讨论前, 作者带领读者回忆一下流数.

设
\begin{align*}
    f = a_0 + a_1 x + a_2 x^2 + \cdots + a_i x^i + \cdots + a_n x^n
\end{align*}
是整式. $f$ 的流数也是整式:
\begin{align*}
    Df = 0 + a_1 + 2a_2 x + \cdots + i a_i x^{i-1} + \cdots + n a_n x^{n-1}.
\end{align*}
由此可知: 若 $f$ 是数, 则 $Df$ 是 $0$; 若 $f$ 的次 $n \geq 1$, 则 $Df$ 的次为 $n - 1$.

设 $a$, $b$ 是数; 设 $f$, $g$ 是整式; 设 $m$ 是正整数. 流数有如下运算规则:
\begin{align*}
     & D(af + bg) = aDf + bDg,          \\
     & D(fg) = Df \cdot g + f \cdot Dg, \\
     & D(f^m) = mf^{m-1} Df.
\end{align*}

\begin{example}
    设 $f = x^8 + x^4 + 1$, $g = 3x^2 - 9x + 1$. 不难算出
    \begin{align*}
        Df = 8x^7 + 4x^3, \quad Dg = 6x - 9.
    \end{align*}

    (i) $f$ 与 $g$ 的和:
    \begin{align*}
        f + g = x^8 + x^4 + 3x^2 - 9x,
    \end{align*}
    故
    \begin{align*}
        D(f + g) = 8x^7 + 4x^3 + 6x - 9.
    \end{align*}
    这恰好与 $Df + Dg$ 相等.

    (ii) $f$ 与 $g$ 的积:
    \begin{align*}
        fg
        = {} & x^8 g + x^4 g + g                                            \\
        = {} & (3x^10 - 9x^9 + x^8) + (3x^6 - 9x^5 + x^4) + (3x^2 - 9x + 1) \\
        = {} & 3x^10 - 9x^9 + x^8 + 3x^6 - 9x^5 + x^4 + 3x^2 - 9x + 1.
    \end{align*}
    故
    \begin{align*}
        D(fg) = 30x^9 - 81x^8 + 8x^7 + 18x^5 - 45x^4 + 4x^3 + 6x - 9.
    \end{align*}
    而
    \begin{align*}
         & \begin{aligned}
            Df \cdot g
            = {} & (8x^7 + 4x^3) (3x^2 - 9x + 1)            \\
            = {} & 24 x^9-72 x^8+8 x^7+12 x^5-36 x^4+4 x^3, \\
        \end{aligned}  \\
         & \begin{aligned}
            f \cdot Dg
            = {} & (x^8 + x^4 + 1) (6x - 9)       \\
            = {} & 6 x^9-9 x^8+6 x^5-9 x^4+6 x-9,
        \end{aligned}
    \end{align*}
    故
    \begin{align*}
        Df \cdot g + f \cdot Dg = 30 x^9-81 x^8+8 x^7+18 x^5-45 x^4+4 x^3+6 x-9.
    \end{align*}
    这与 $D(fg)$ 一致.

    (iii) 不难算出
    \begin{align*}
         & (x^2 + x + 1)^2 = x^4+2 x^3+3 x^2+2 x+1,             \\
         & (x^2 + x + 1)^3 = x^6+3 x^5+6 x^4+7 x^3+6 x^2+3 x+1,
    \end{align*}
    故
    \begin{align*}
         & f^2 = (x^8 + x^4 + 1)^2 = x^{16}+2 x^{12}+3 x^8+2 x^4+1,                   \\
         & f^3 = (x^8 + x^4 + 1)^3 = x^{24}+3 x^{20}+6 x^{16}+7 x^{12}+6 x^8+3 x^4+1.
    \end{align*}
    所以
    \begin{align*}
        D(f^3) = 24 x^{23}+60 x^{19}+96 x^{15}+84 x^{11}+48 x^7+12 x^3.
    \end{align*}
    因为
    \begin{align*}
        3f^2 Df
        = {} & 3(x^8 + x^4 + 1)^2 (8x^7 + 4x^3)                       \\
        = {} & 12 x^3 (2x^4 + 1) (x^{16}+2 x^{12}+3 x^8+2 x^4+1)      \\
        = {} & 12 x^3 (2 x^{20}+5 x^{16}+8 x^{12}+7 x^8+4 x^4+1)      \\
        = {} & 24 x^{23}+60 x^{19}+96 x^{15}+84 x^{11}+48 x^7+12 x^3,
    \end{align*}
    故
    \begin{align*}
        D(f^3) = 3f^2 Df.
    \end{align*}
\end{example}

\myLine

温习流数后, 我们进入本文的正题.

\begin{definition}
    设 $p$ 是不可约的整式. 设 $m$ 是非负整数. 设整式 $f \neq 0$. 若 $p^m$ 是 $f$ 的因子, 但 $p^{m+1}$ 不是 $f$ 的因子, 则 $p$ 是 $f$ 的 $m$ 重因子\myFN{此定义是合理的. 因为 $f \neq 0$, 故次是非负整数 $n$. 因为 $p$ 是不可约的, 故 $p$ 的次是正整数 $b$. 若整数 $k \geq \frac{n+1}{b}$, 则 $p^k$ 的次 $bk \geq n+1 > n$. 此时, $p^k$ 当然不是 $f$ 的因子. $p^0 = 1$ 显然是 $f$ 的因子. 所以, 从左向右看 $p^k$, $p^{k-1}$, $\cdots$, $p^0$, 必有某整数 $m$ 使 $k-m$ 个整式 $p^k$, $p^{k-1}$, $\cdots$, $p^{m+1}$ 不是 $f$ 的因子, 但 $p^m$ 是 $f$ 的因子.}. 若 $m = 0$, $p$ 当然不是 $f$ 的因子; 若 $m = 1$, 则 $p$ 是 $f$ 的单因子 \term{simple factor}; 若 $m \geq 2$, 则 $p$ 是 $f$ 的重因子 \term{multiple factor}.
\end{definition}

\begin{proposition}
    设 $p$ 是不可约的整式. 设 $m$ 是非负整数. 设整式 $f \neq 0$. $p$ 是 $f$ 的 $m$ 重因子的一个必要与充分条件是: 存在整式 $g$ 使 $f = p^m g$, 且 $p$ 不是 $g$ 的因子.
\end{proposition}

\begin{pf}
    先看必要性. 设 $p$ 是 $f$ 的 $m$ 重因子. 所以, $p^m$ 是 $f$ 的因子, 也就是说, 存在整式 $h$ 使 $f = p^m h$. 我们的目标是: 证明 $p$ 不是 $h$ 的因子. 用反证法. 若存在整式 $\ell$ 使 $h = p\ell$, 则 $f = p^{m+1} \ell$. 所以, $p^{m+1}$ 是 $f$ 的因子. 不过, 既然 $p$ 是 $f$ 的 $m$ 重因子, $p^{m+1}$ 不是 $f$ 的因子. 矛盾!

    再看充分性. 设整式 $g$ 使 $f = p^m g$, 且 $p$ 不是 $g$ 的因子. 所以, $p^m$ 是 $f$ 的因子. 我们的目标是: 证明 $p^{m+1}$ 不是 $f$ 的因子. 还是用反证法. 若整式 $k$ 使 $f = p^{m+1} k$, 则 $p^{m+1} k = p^m g$. 因为 $p \neq 0$, 故 $p^m \neq 0$, 从而可从等式二边消去 $p^m$. 即 $pk = g$. 所以, $p$ 是 $g$ 的因子. 矛盾!
\end{pf}

\begin{example}
    设
    \begin{align*}
        f = (x + 1) (x^2 - 3)^2 (x^2 + 4)^3.
    \end{align*}

    若视 $f$ 为有理系数整式, 则 $x+1$, $x^2 - 3$, $x^2 + 4$ 都是不可约的\myFN{$x+1$ 的次为 $1$, 故它是不可约的. 若有理系数整式 $x^2 + b$ 是可约的, 则存在有理数 $s$, $t$ 使 $x^2 + b = (x - s)(x - t)$. 比较系数, 有 $s+t=0$, $st = b$. 所以 $s^2 = t^2 = -b$. 当 $b = -3$ 时, $s^2 = t^2 = 3$. 不过, 有理数的平方一定不是 $3$, 故 $x^2 - 3$ 是不可约的. 同理, $b = 4$ 时, $s^2 = t^2 = -4$. 有理数的平方一定是非负的, 故 $x^2 + 4$ 也是不可约的. 顺便一提, 因为实数的平方也是非负的, 故就算视 $x^2 + 4$ 为实系数整式, 它也不是可约的.}. 由此易知: $x+1$ 是 $f$ 的 $1$ 重因子 (亦即单因子); $x^2 - 3$ 是 $f$ 的 $2$ 重因子; $x^2 + 4$ 是 $f$ 的 $3$ 重因子; $x^2 - 3$ 与 $x^2 + 4$ 都是 $f$ 的重因子; 不跟 $x+1$, $x^2 - 3$ 或 $x^2 + 4$ 相伴的不可约的整式都是 $f$ 的 $0$ 重因子.

    若视 $f$ 为实系数整式, 则 $x+1$, $x^2+4$ 仍是不可约的. 所以, $x+1$ 仍为 $f$ 的单因子, $x^2+4$ 仍为 $f$ 的 $3$ 重因子. 可是
    \begin{align*}
        x^2 - 3 = (x + \sqrt{3}) (x - \sqrt{3}),
    \end{align*}
    从而
    \begin{align*}
        f = (x + 1)(x + \sqrt{3})^2 (x - \sqrt{3})^2 (x^2 + 4)^3.
    \end{align*}
    也就是说, $x^2 - 3$ ``不配当'' $m$ 重因子, 此处 $m$ 是任意的非负整数. 不过, $x + \sqrt{3}$ 与 $x - \sqrt{3}$ 是可以的, 且它们都是 $f$ 的 $2$ 重因子.

    若视 $f$ 为复系数整式, 则 $x+1$ 依旧为 $f$ 的单因子. $x + \sqrt{3}$ 与 $x - \sqrt{3}$ 都是 $f$ 的 $2$ 重因子. 不过, $x^2 + 4$ 是可约的:
    \begin{align*}
        x^2 + 4 = (x + 2\mathrm{i}) (x - 2\mathrm{i}).
    \end{align*}
    所以
    \begin{align*}
        f = (x + 1)(x + \sqrt{3})^2 (x - \sqrt{3})^2 (x + 2\mathrm{i})^3 (x - 2\mathrm{i})^3.
    \end{align*}
    类似地, $x^2 + 4$ 也不配成为 $m$ 重因子; $x + 2\mathrm{i}$ 与 $x - 2\mathrm{i}$ 都是 $f$ 的 $3$ 重因子.

    作者举本例的目的是使读者明白: $f$ 的重因子 (究竟是什么) 与系数的范围有关. 这跟之前讨论不可约的整式时是类似的.
\end{example}

下面的命题是有用的.

\begin{proposition}
    设 $p$ 是不可约的整式. 设整式 $f \neq 0$. $p$ 是 $f$ 的重因子的一个必要与充分条件是: $p^2$ 是 $f$ 的因子.
\end{proposition}

\begin{pf}
    先看必要性. 既然 $p$ 是 $f$ 的重因子, 则 $p^m$ 是 $f$ 的因子, 这里 $m$ 是某个不低于 $2$ 的整数. 因为 $p^2$ 是 $p^m$ 的因子, 故 $p^2$ 是 $f$ 的因子.

    再看充分性. 设整式 $g$ 使 $f = p^2 g$. 因为 $f \neq 0$, 故 $g \neq 0$. 设 $p$ 是 $g$ 的 $j$ 重因子, 这里 $j$ 是非负整数. 所以, 存在整式 $h$ 使 $g = p^j h$, 且 $p$ 不是 $h$ 的因子. 故 $f = p^{2+j} h$, 且 $p$ 不是 $h$ 的因子. 因为 $2+j$ 是不低于 $2$ 的整数, 故 $p$ 是 $f$ 的重因子.
\end{pf}

\begin{proposition}
    设 $f$ 是次高于 $0$ 的整式. $f$ 一定不是 $Df$ 的因子. 因为不可约的整式的次至少为 $1$, 故若 $p$ 是不可约的整式, 则 $p$ 一定不是 $Dp$ 的因子.
\end{proposition}

\begin{pf}
    设 $\deg f = n \geq 1$. 则 $\deg Df = n - 1$. 用反证法. 若 $f$ 是 $Df$ 的因子, 则有 (非零) 整式 $h$ 使 $Df = pf$. 从而
    \begin{align*}
        n - 1 = \deg Df = \deg f + \deg h \geq \deg f = n.
    \end{align*}
    这是矛盾!
\end{pf}

下面的命题揭示了流数与重因子的关系.

\begin{proposition}
    设 $p$ 是不可约的整式. 设 $m$ 是正整数. 设整式 $f \neq 0$. 若 $p$ 是 $f$ 的 $m$ 重因子, 则 $p$ 是 $Df$ 的 $m-1$ 重因子. 由此可见:

    (i) 若 $p$ 是 $f$ 的单因子 ($m = 1$), 则 $p$ 不是 $Df$ 的因子;

    (ii) 若 $p$ 是 $f$ 的重因子 ($m \geq 2$), 则 $p$ 也是 $Df$ 的因子;

    (iii) $p$ 是 $f$ 的重因子的一个必要与充分条件是: $p$ 是 $f$ 与 $Df$ 的公因子.
\end{proposition}

\begin{pf}
    设 $f = p^m g$, 其中 $p$ 不是 $g$ 的因子. 从而
    \begin{align*}
        Df
        = {} & D(p^m) \cdot g + p^m \cdot Dg          \\
        = {} & mp^{m-1} Dp \cdot g + p^m \cdot Dg     \\
        = {} & p^{m-1} \underbrace{(mgDp + pDg)}_{h}.
    \end{align*}
    所以, $p^{m-1}$ 是 $Df$ 的因子. 我们的目标是: 证明 $p$ 不是 $h$ 的因子.

    我们先证明: $p$ 不是 $mgDp$ 的因子. 用反证法. 若 $p$ 是 $mgDp$ 的因子, 则 $p$ 是 $mg$ 的因子, 或 $p$ 是 $Dp$ 的因子. 因为 $p$ 不是 $g$ 的因子, 故 $p$ 也不是 $mg$ 的因子 (此判断又可以用反证法来证; 这里, 作者就不赘述了). 这样, $p$ 一定是 $Dp$ 的因子. 不过, 根据上个命题, $p$ 一定不是 $Dp$ 的因子. 矛盾!

    现在我们总算可以证明 $p$ 不是 $h$ 的因子了. 还是用反证法. 若 $p$ 是 $h$ 的因子, 则因 $p$ 显然是 $pDg$ 的因子, 故 $p$ 是 $mgDp = h - pDg$ 的因子. 这跟上段文字得到的结论矛盾!

    在证明这个关系后, (i) 与 (ii) 就相当显然了. 合并 (i) (ii), 即可得 (iii).
\end{pf}

下面的命题讨论了 $f$ 与 $Df$ 的最大公因子. (vii) 是重要的、有用的.

\begin{proposition}
    设整式 $f \neq 0$. 设 $p_1$, $p_2$, $\cdots$, $p_k$ 是 $f$ 的重因子. 设 $p_i$ 不与 $p_j$ 相伴 ($i \neq j$). (这说明, $p_1$, $p_2$, $\cdots$, $p_k$ 是 $f$ 的 ``互不相伴的'' 重因子.) 设 ``若不可约的整式 $u$ 是 $f$ 的重因子, 则 $u$ 必跟某 $p_\ell$ 相伴'' 是真命题. (因为 $p_1$, $p_2$, $\cdots$, $p_k$ 互不相伴, 故 $u$ 只能跟一个 $p_\ell$ 相伴. 并且, 这说明, $p_1$, $p_2$, $\cdots$, $p_k$ 是 $f$ 的重因子的 ``代表''.) 设 $p_1$, $p_2$, $\cdots$, $p_k$ 分别是 $f$ 的 $m_1$, $m_2$, $\cdots$, $m_k$ 重因子, 其中 $m_1$, $m_2$, $\cdots$, $m_k$ 全是不低于 $2$ 的整数.

    (i) 设 $\ell$ 是 $1$ 至 $k$ 间的整数. $M_\ell = p_\ell^{m_\ell - 1}$ 是 $f$ 与 $Df$ 的公因子.

    (ii) 设 $s$, $t$ 是 $1$ 至 $k$ 间的整数, 且 $s \neq t$. $M_s$ 与 $M_t$ 互素. 也就是说, $M_1$, $M_2$, $\cdots$, $M_k$ PRP.

    (iii) $M_1 M_2 \cdots M_{\ell - 1}$ 与 $M_\ell$ 互素.

    (iv) $M = M_1 M_2 \cdots M_k$ 是 $f$ 与 $Df$ 的公因子.

    (v) $M$ 是 $f$ 与 $Df$ 的最大公因子.

    (vi) 存在整式 $w$ 使 $f = p_1^{m_1} p_2^{m_2} \cdots p_k^{m_k} w$, 且 $p_1$, $p_2$, $\cdots$, $p_k$ 都不是 $w$ 的因子.

    (vii) 设整式 $h$ 适合 $f = hM$. 设 $p$ 是不可约的整式. 若 $p$ 是 $f$ 的因子, 则 $p$ 是 $h$ 的单因子. 也就是说, $h$ 与 $f$ 有相同的不可约的因子, 但 $h$ 无重因子. (显然 $h$ 的因子都是 $f$ 的因子; 本条有意思的地方是: $f$ 的不可约的因子一定是 $h$ 的因子.)
\end{proposition}

\begin{pf}
    (i) 因为 $p_\ell$ 是 $f$ 的 $m_\ell$ 重因子 ($m_\ell \geq 2$), 故 $p_\ell$ 是 $Df$ 的 $m_\ell - 1$ 重因子 ($m_\ell - 1 \geq 1$). 所以 $M_\ell$ 是 $f$ 与 $Df$ 的公因子.

    (ii) 因为 $s \neq t$, 故 $p_s$ 不与 $p_t$ 相伴, 从而 $p_s$ 与 $p_t$ 互素. 也就是说, $p_1$, $p_2$, $\cdots$, $p_k$ PRP. 由 PRP 的性质, 知: $M_1$, $M_2$, $\cdots$, $M_k$ 亦 PRP.

    (iii) 由 PRP 的性质, 立得.

    (iv) 设 $d$ 是 $f$ 与 $Df$ 的最大公因子. 从而 $M_1$, $M_2$, $\cdots$, $M_k$ 都是 $d$ 的因子. 由 PRP 的性质, 知: $M$ 是 $d$ 的因子. 故 $M$ 当然是 $f$ 与 $Df$ 的公因子.

    (v) 设 $d$ 是 $f$ 与 $Df$ 的最大公因子. 由 (iv) 知, $M$ 是 $d$ 的因子. 所以, 存在整式 $g$ 使 $d = Mg$. 因为 $f \neq 0$, 故 $d \neq 0$, 从而 $g \neq 0$. 我们证明: $g$ 一定是单位. 此时, $d$ 与 $M$ 相伴, 故 $M$ 也是 $f$ 与 $Df$ 的最大公因子.

    用反证法. 若 $g$ 不是单位, 则存在某个不可约的整式 $q^{\prime}$ 使 $q^{\prime}$ 是 $g$ 的因子. 当然, $q^{\prime}$ 是 $d$ 的因子, 故 $q^{\prime}$ 是 $f$ 与 $Df$ 的公因子. 所以, $q^{\prime}$ 是 $f$ 的重因子. 所以, $q^{\prime}$ 与某个 $p_{\ell}$ 相伴. 从而必有单位 $\varepsilon$ 使 $q^{\prime} = \varepsilon p_{\ell}$. 所以, $p_{\ell}$ 是 $g$ 的因子. 因为 $M_\ell$ 是 $M$ 的因子, 故 $p_{\ell}^{m_\ell - 1} p_{\ell} = p_{\ell}^{m_\ell}$ 是 $Mg = d$ 的因子. 所以 $p_{\ell}^{m_\ell}$ 是 $Df$ 的因子. 这跟 $p_\ell$ 是 $Df$ 的 $m_\ell - 1$ 重因子矛盾!

    (vi) 因为 $p_1$, $p_2$, $\cdots$, $p_k$ PRP, 故 $p_1^{m_1}$, $p_2^{m_2}$, $\cdots$, $p_k^{m_k}$ 亦 PRP. $p_1^{m_1}$, $p_2^{m_2}$, $\cdots$, $p_k^{m_k}$ 都是 $f$ 的因子, 故 $p_1^{m_1} \cdot p_2^{m_2} \cdots p_k^{m_k}$ 是 $f$ 的因子. 所以, 存在整式 $w$ 使 $f = p_1^{m_1} p_2^{m_2} \cdots p_k^{m_k} w$.

    现在我们说明, 每个 $p_\ell$ 都不是 $w$ 的因子. 用反证法. 若存在整式 $v$ 使 $w = p_\ell v$, 则
    \begin{align*}
        f = \underbrace{(p_1^{m_1} \cdots p_{\ell-1}^{m_{\ell-1}})}_{\text{$(\ell - 1)$ $p$\apostrophe s}} p_{\ell}^{m_\ell + 1} \underbrace{(p_{\ell+1}^{m_{\ell + 1}} \cdots p_k^{m_k})}_{\text{$(k-\ell)$ $p$\apostrophe s}} v.
    \end{align*}
    故 $p_{\ell}^{m_\ell + 1}$ 是 $f$ 的因子. 可是, $p_\ell$ 是 $f$ 的 $m_\ell$ 重因子, 矛盾!

    (vii) 由 (v), $M = p_1^{m_1 - 1} p_2^{m_2 - 1} \cdots p_k^{m_k - 1}$ 是 $f$ 与 $Df$ 的最大公因子. 由 (vi), 知
    \begin{align*}
        f
        = {} & p_1^{m_1} p_2^{m_2} \cdots p_k^{m_k} w      \\
        = {} & (M_1 p_1) (M_2 p_2) \cdots (M_k p_k) w      \\
        = {} & (M_1 M_2 \cdots M_k) (p_1 p_2 \cdots p_k) w \\
        = {} & M (p_1 p_2 \cdots p_k w).
    \end{align*}
    所以 $h = p_1 p_2 \cdots p_k w$, 且 $p_1$, $p_2$, $\cdots$, $p_k$ 都不是 $w$ 的因子.

    设不可约的整式 $p$ 是 $f$ 的因子. 所以, $p$ 要么是 $f$ 的单因子, 要么是 $f$ 的重因子.

    若 $p$ 是 $f$ 的重因子, 则 $p$ 恰与某一个 $p_\ell$ 相伴, 即存在单位 $\varepsilon$ 使 $p_\ell = \varepsilon p$. 故
    \begin{align*}
        h
        = {} & p_\ell (p_1 \cdots p_{\ell - 1} p_{\ell + 1} \cdots p_k w)                          \\
        = {} & p \underbrace{(\varepsilon p_1 \cdots p_{\ell - 1} p_{\ell + 1} \cdots p_k w)}_{Q}.
    \end{align*}
    $p$ 不是 $Q$ 的因子 (也就是说, $p$ 不是 $h$ 的重因子). 用反证法. 如果 $p$ 是 $Q$ 的因子, 则因 $p$ 是不可约的, 故 $p$ 是 $p_1$, $\cdots$, $p_{\ell - 1}$, $p_{\ell + 1}$, $\cdots$, $p_k$ 或 $w$ 的因子, 矛盾!

    若 $p$ 是 $f$ 的单因子, 则由 (vi), $p$ 一定是 $p_1^{m_1}$, $p_2^{m_2}$, $\cdots$, $p_k^{m_k}$ 或 $w$ 的因子. $p$ 一定不是 $p_1$, $p_2$, $\cdots$, $p_k$ 的任意一个的因子, 故 $p$ 一定是 $w$ 的因子. 所以 $p$ 也是 $h$ 的因子. $p$ 能为 $h$ 的重因子吗? 不能. 如果 $p$ 是 $h$ 的重因子, 则 $p^2$ 是 $h$ 的因子, 故 $p$ 是 $f$ 的重因子, 矛盾!
\end{pf}

为方便, 我们给出
\begin{proposition}
    设整式 $f \neq 0$. $f$ 无重因子的一个必要与充分条件是: $f$ 与 $Df$ 互素.
\end{proposition}

\begin{pf}
    先看必要性. 反证法. 若 $f$ 与 $Df$ 不互素, 则存在不可约的整式 $p$ 使 $p$ 是 $f$ 与 $Df$ 的公因子. 所以 $p$ 是 $f$ 的重因子. 矛盾!

    再看充分性. 还是用反证法. 若 $f$ 有重因子 $q$, 则 $q$ 是 $f$ 与 $Df$ 的公因子. 故 $f$ 与 $Df$ 不互素. 矛盾!
\end{pf}

因为问题 ``$f$ 是否与 $g$ 互素'' 的回答不因系数的范围扩大而改变, 故我们有
\begin{proposition}
    设 $K$, $E$ 是三文字 $\mathbb{Q}$, $\mathbb{R}$, $\mathbb{C}$ 的任意二个, 且 $E$ 的范围不比 $K$ 的范围窄. 设 $f$ 与 $g$ 是 $K$ 上的整式.

    (i) 设 $f$ 作为 $K$ 上的整式有重因子. 所以, $f$ 与 $Df$ 在 $K$ 上的整式中不互素. 所以, $f$ 与 $Df$ 在 $E$ 上的整式中不互素. 所以, $f$ 作为 $E$ 上的整式有重因子.

    (ii) 设 $f$ 作为 $K$ 上的整式无重因子. 所以, $f$ 与 $Df$ 在 $K$ 上的整式中互素. 所以, $f$ 与 $Df$ 在 $E$ 上的整式中互素. 所以, $f$ 作为 $E$ 上的整式无重因子.

    简单地说, 问题 ``$f$ 是否有重因子'' 的回答不因系数的范围扩大而改变.
\end{proposition}

作者举一个例. 此例的运算量比较大; 请读者忍耐一会{\scriptsize 儿}. 有兴趣的读者可自己试试此例的 $f$; 无兴趣的读者可试试 $f = x^4-x^2+2 x+2$ (也可 ``就看看, 不算''; 毕竟, 作者无权也无法强迫读者动手). 不过, 作者还是先给出一个有用的评注.

\begin{remark}
    读者或许有这样的经验: 不是整数的有理数的加、乘运算似乎没有整数的加、乘容易. 带馀除法时, 我们往往会碰到商或馀式不是整系数的情形. 如果只是执行一次带馀除法, 读者 (也包括作者) 还是可以接受的. 可是, 我们用辗转相除法找二个整式的最大公因子时, 要执行多次带馀除法. 作者愿意解救读者\myFN{这是给不用计算机计算的读者的建议; 如果读者用计算机计算, 这些建议就没什么用了.}.

    设 $f$ 与 $g$ 是二个整式. 无妨设 $g \neq 0$. 设 $\varepsilon_1$ 与 $\varepsilon_2$ 是单位. 若 $f = gq + r$, 则
    \begin{align*}
        \varepsilon_1 f
        = {} & \varepsilon_1 gq + \varepsilon_1 r                                        \\
        = {} & \varepsilon_1 (\varepsilon_2^{-1} \varepsilon_2) g + \varepsilon_1 r      \\
        = {} & (\varepsilon_2 g) (\varepsilon_1 \varepsilon_2^{-1}) + (\varepsilon_1 r).
    \end{align*}
    也就是说, 商与馀式顶多差个单位.

    设 $f$ 与 $g$ 的最大公因子为 $d_1$, $\varepsilon_1 f$ 与 $\varepsilon_2 g$ 的最大公因子为 $d_2$. 我们看 $d_1$ 与 $d_2$ 的关系. 因为 $f$ 是 $\varepsilon_1 f$ 的因子, $g$ 是 $\varepsilon_2 g$ 的因子, 故 $d_1$ 是 $\varepsilon_1 f$ 与 $\varepsilon_2 g$ 的公因子. 这样, $d_1$ 是 $d_2$ 的因子. 不过, $\varepsilon_1 f$ 是 $f = \varepsilon_1^{-1} \varepsilon_1 f$ 的因子, $\varepsilon_2 g$ 是 $g = \varepsilon_2^{-1} \varepsilon_2 g$ 的因子, 故 $d_2$ 是 $f$ 与 $g$ 的公因子. 这样, $d_2$ 是 $d_1$ 的因子. 所以 $d_1$ 与 $d_2$ 相伴.

    综上可知: 在辗转相除法里, 将被除式与除式\myFN{在 $f = gq + r$ ($\deg r < \deg g$) 里, $f$ 是 ``被除式'' \term{dividend}, $g$ 是 ``除式'' \term{divisor}.}乘单位因子 (不要求一样), 不影响最大公因子的结果.
\end{remark}

\begin{example}
    设
    \begin{align*}
        f = x^9-2 x^6+3 x^5-6 x^4+12 x-8.
    \end{align*}
    我们看看 $f$ 是否有重因子.

    不难算出
    \begin{align*}
        Df = 9 x^8-12 x^5+15 x^4-24 x^3+12.
    \end{align*}
    所以
    \begin{align*}
        f = \frac{x}{9} Df - \frac{2}{3} \underbrace{(x^6-2 x^5+5 x^4-16 x+12)}_{r_0}.
    \end{align*}
    用 $r_0$ (这里的 $r_0$ 不是馀式!) 除 $Df$, 有
    \begin{align*}
        Df = 9(x^2+2x-1) r_0 - 60 \underbrace{(2 x^5-x^4-2 x^3-3 x^2+6 x-2)}_{r_1}.
    \end{align*}
    用 $r_1$ 除 $r_0$, 有
    \begin{align*}
        r_0 = \frac{1}{4} (2x-3) r_1 + \frac{21}{4} \underbrace{(x^4-x^2-2 x+2)}_{r_2}.
    \end{align*}
    用 $r_2$ 除 $r_1$, 有
    \begin{align*}
        r_1 = (2x-1) r_2.
    \end{align*}
    所以, $r_2$ 就是 $f$ 与 $Df$ 的最大公因子. 记 $M = r_2 = x^4-x^2-2 x+2$. 利用带馀除法, 可算出适合 $f = hM$ 的 $h$:
    \begin{align*}
        f = (x^5+x^3+2 x-4) M \implies h = x^5+x^3+2 x-4.
    \end{align*}

    上面的计算告诉我们, $f$ 有重因子. 虽然我们不知道 $f$ 的重因子是什么, 但我们知道 $f$ 有重因子! 这很有用, 因为我们还不知道怎么找 $f$ 的不可约的因子 (之后作者会告诉读者执行此事的方法).

    作为一个额外的挑战, 我们看看 $h$ 是否有重因子. 按照前面的命题, 这么作出的 $h$ 跟 $f$ 有相同的不可约的因子, 且 $h$ 无重因子. 假如我们 ``忘记了'' 这个结论呢? 我们可以求 $h$ 与 $Dh$ 的最大公因子呀! 不难写出
    \begin{align*}
        Dh = 5x^4 + 3x^2 + 2.
    \end{align*}
    用 $Dh$ 除 $h$:
    \begin{align*}
        h = \frac{x}{5} Dh + \frac{2}{5} \underbrace{(x^3+4 x-10)}_{r_0}.
    \end{align*}
    用 $r_0$ 除 $Dh$:
    \begin{align*}
        Dh = 5x r_0 + \underbrace{(-17x^2 + 50x + 2)}_{r_1}.
    \end{align*}
    用 $r_1$ 除 $r_0$:
    \begin{align*}
        r_0 = -\frac{1}{289} (17x + 50) r_1 + \frac{90}{289} \underbrace{(41x-31)}_{r_2}.
    \end{align*}
    用 $r_2$ 除 $r_1$:
    \begin{align*}
        r_1 = -\frac{1}{1\,681} (697x - 1\,523) r_2 + \underbrace{\frac{50\,575}{1\,681}}_{r_3}.
    \end{align*}
    到此为止, 我们不用执行带馀除法了 ($r_3$ 是单位; 单位当然是 $r_2$ 的因子). 由此可见, 单位就是 $h$ 与 $Dh$ 的最大公因子, 故 $h$ 无重因子.
    % $f$ 与 $h$ 的不可约的因子有哪些呢? $f$ 的次为 $9$; $h$ 的次为 $5$; $M$ 的次为 $4$. 我们可以选次最低的. 所以, 我们可以看看 $M$ (也就是, 看看 $f$ 的重因子):
    % \begin{align*}
    %     M
    %     = {} & x^2 (x^2 - 1) - 2(x - 1)             \\
    %     = {} & x^2 (x+1) (x-1) - 2(x - 1)           \\
    %     = {} & (x^2 (x+1) - 2) (x - 1)              \\
    %     = {} & (x^3 + x^2 - 2) (x - 1)              \\
    %     = {} & (x^3 - 1 + x^2 - 1) (x - 1)          \\
    %     = {} & ((x-1) (x^2+x+1) + (x-1)(x+1)) (x-1) \\
    %     = {} & (x-1)^2 (x^2+2x+2).
    % \end{align*}
    % 所以, $x-1$ 与 $x^2+2x+2$ 都是 $f$ 的重因子\myFN{}. 它们当然也是 $h$ 的单因子:
    % \begin{align*}
    %     x^5+x^3+2 x-4 =       & (x-1) (x^4+x^3+2 x^2+2 x+4), \\
    %     x^4+x^3+2 x^2+2 x+4 = & (x^2+2x+2) (x^2-x+2).
    % \end{align*}
\end{example}

最后, 我们说, ``重因子'' 是 ``重根'' 的推广. 我们当初习得的 ``重根'' 的定义如下:

\begin{definition}
    设 $a$ 是数. 设 $f(x)$ 是整式. 设 $f(x) \neq 0$. 设 $a$ 是 $f(x)$ 的根. 那么, 存在唯一的整式 $q(x)$ 使 $f(x) = (x - a) q(x)$, 且 $q(x) \neq 0$. 若 $q(a) = 0$, 则说 $a$ 是 $f(x)$ 的一个重根. 若 $q(a) \neq 0$, 则说 $a$ 是 $f(x)$ 的一个单根.
\end{definition}

我们可用因子的语言改写此定义:
\begin{definition}
    设 $a$ 是数. 设 $f(x)$ 是整式. 设 $f(x) \neq 0$. 设 $x - a$ 是 $f(x)$ 的因子. 那么, 存在唯一的整式 $q(x)$ 使 $f(x) = (x - a) q(x)$, 且 $q(x) \neq 0$. 若 $x - a$ 是 $q(x)$ 的因子, 则说 $a$ 是 $f(x)$ 的一个重根. 若 $x - a$ 不是 $q(x)$ 的因子, 则说 $a$ 是 $f(x)$ 的一个单根.
\end{definition}

利用因子的性质, 这个定义可写为
\begin{definition}
    设 $a$ 是数. 设 $f(x)$ 是整式. 设 $f(x) \neq 0$. 设 $x - a$ 是 $f(x)$ 的因子. 若 $(x - a)^2$ 是 $f(x)$ 的因子, 则说 $a$ 是 $f(x)$ 的一个重根. 若 $(x - a)^2$ 不是 $f(x)$ 的因子, 则说 $a$ 是 $f(x)$ 的一个单根.
\end{definition}

由此, 不难看出重因子与重根的关系.
\begin{proposition}
    设 $a$ 是数. 设 $f(x)$ 是整式. 设 $f(x) \neq 0$. 设 $x - a$ 是 $f(x)$ 的因子. ``$x-a$ 是 $f(x)$ 的重 (单) 因子'' 的一个必要与充分条件是 ``$a$ 是 $f(x)$ 的重 (单) 根''.
\end{proposition}

作者就说这么多吧! 再见, 读者.
