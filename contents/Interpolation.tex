\subsection*{Interpolation}
\addcontentsline{toc}{subsection}{Interpolation}
\markright{Interpolation}

本节讨论多项式插值问题\period

``插值'' 听上去可能比较陌生\period 不过, 您在初中一定见过这样的问题:

\begin{example}
    已知一次函数的图像经过点 $(-1,2)$ 与 $(1,3)$, 求其解析式\period
\end{example}

\begin{example}
    已知二次函数的图像经过点 $(-1,-1)$, $(1,1)$ 与 $(2,5)$, 求其解析式\period
\end{example}

在初中, 我们是用 ``待定系数法'' \term{the method of undetermined coefficients} 求解的\period 它的基本思想是 ``求什么, 设什么''\period 设此一次函数的解析式为
\begin{align*}
    y = ax + b, \quad a \neq 0 \period
\end{align*}
代入已知条件, 得到二元一次方程组
\begin{align*}
    \begin{cases}
        2 = -a + b, \\
        3 = a + b \period
    \end{cases}
\end{align*}
由此可解出
\begin{align*}
    a = \frac12, \quad b = \frac52 \period
\end{align*}
所以此一次函数的解析式为
\begin{align*}
    y = \frac12 x + \frac52 \period
\end{align*}

完全类似地, 设此二次函数的解析式为
\begin{align*}
    y = ax^2 + bx + c, \quad a \neq 0 \period
\end{align*}
代入已知条件, 得到三元一次方程组
\begin{align*}
    \begin{cases}
        -1 = a - b + c, \\
        1 = a + b + c,  \\
        5 = 4a + 2b + c \period
    \end{cases}
\end{align*}
由此可解出
\begin{align*}
    a = 1, \quad b = 1, \quad c = -1 \period
\end{align*}
所以此二次函数的解析式为
\begin{align*}
    y = x^2 + x - 1 \period
\end{align*}

在初中, 一般用左 $y$ 右 $x$ 的等式表示函数 (的解析式)\period 这种表示法强调因变元 \term{dependent variable} $y$ 与自变元 \term{independent variable} $x$ 的关系\period 不过, 既然我们有 $f(x)$ 这样的记号, 那么因变元就不必写出了\period 并且, 我们在前节提到, 我们不再区分多项式与多项式函数\period 所以, 为方便, 我们用另一种方式叙述这二个问题:

\begin{example}
    求次为 $1$ 的多项式 $f(x)$, 使 $f(-1)=2$, $f(1)=3$\period
\end{example}

\begin{example}
    求次为 $2$ 的多项式 $f(x)$, 使 $f(-1)=-1$, $f(1)=1$, $f(2)=5$\period
\end{example}

设 $x_0$, $x_1$, $\cdots$, $x_{n}$ 是 $\FF$ 的 $n+1$ 个互不相同的元\period 这 $n+1$ 个不同的元称为 $n+1$ 个节点 \term{node}\period 设 $y_0$, $y_1$, $\cdots$, $y_{n} \in \FF$\period 通俗地说, 多项式插值 \term{polynomial interpolation} 的任务是: 找一个多项式 $f(x) \in \FF[x]$ 使
\begin{align*}
    f(x_i) = y_i \quad (i = 0,1,\cdots,n),
\end{align*}
且适合 ``附加条件''\period

这里, ``附加条件'' 是有必要的: 如果太松, 可能找出的 $f(x)$ 不止一个; 如果太紧, 则可能找不到 $f(x)$\period

\begin{example}
    找一个多项式 $f(x)$ 使 $f(-1)=-1$, $f(0)=0$, $f(1)=1$\period

    如果不作任何别的约束, 那么 $n$ 是奇数时, $f(x) = x^n$ 适合这些条件\period 不仅如此, 下面的多项式也适合条件:
    \begin{align*}
        \frac{1}{6}x + \frac{1}{3}x^3 + \frac{1}{2}x^5, \quad -x + 2x^7, \quad \frac{x + x^3 + \cdots + x^{2k-1}}{k} \period
    \end{align*}

    在初中, 我们知道, 若平面直角坐标系的三点 $A$, $B$, $C$ 不在同一直线上, 且任意二点的连线既不与 $y$ 轴平行也不与 $y$ 轴重合, 则存在 (唯一的) 二次函数 $y = ax^2 + bx + c$ ($a \neq 0$) 使其图像过此三点\period 假如 ``附加条件'' 是 ``$f(x)$ 是次为 $2$ 的多项式'' 呢? 设
    \begin{align*}
        f(x) = ax^2 + bx + c, \quad a \neq 0 \period
    \end{align*}
    代入已知条件, 得到三元一次方程组
    \begin{align*}
        \begin{cases}
            -1 = a - b + c, \\
            0 = c,          \\
            1 = a + b + c \period
        \end{cases}
    \end{align*}
    由此可解出
    \begin{align*}
        a = 0, \quad b = 1, \quad c = 0 \period
    \end{align*}
    这与假定 $a \neq 0$ 不符\period 所以, 这个条件太紧了\period
\end{example}

有没有什么 ``松紧得当的'' ``附加条件'' 呢? 回想一下这个命题:

\begin{proposition}
    设 $a_0$, $b_0$, $a_1$, $b_1$, $\cdots$, $a_n$, $b_n$ 是 $\FF$ 的元\period 设 $n$ 是非负整数\period 设
    \begin{align*}
        f(x) = \sum_{i = 0}^n a_i x^i, \quad g(x) = \sum_{i = 0}^n b_i x^i \period
    \end{align*}
    若 $t_0$, $t_1$, $\cdots$, $t_n$ 是 $n+1$ 个互不相同的 $\FF$ 的元, 且
    \begin{align*}
        f(t_0) = g(t_0), \quad f(t_1) = g(t_1), \quad \cdots, \quad f(t_n) = g(t_n),
    \end{align*}
    则 $f(x)$ 必等于 $g(x)$\period 通俗地说, 若次不高于 $n$ (且系数为 $\FF$ 的元) 的二个多项式若在多于 $n$ 处取一样的值, 则这二个多项式相等\period
\end{proposition}

由此, 我们可以试着作出这样的 ``附加条件'': 多项式的次低于节点数\period 至少, 这个条件不是太松: 因为上面的命题说, 这样的多项式若存在, 必唯一\period

这个 ``附加条件'' 一定能让我们求出这个多项式吗? 不好说\period

\begin{example}
    如果把 $\FF$ 跟 $\FF[x]$ 改为 $\ZZ$ 跟 $\ZZ[x]$, 那么就没有 $1$ 次多项式 $f(x)$ 使 $f(-1)=2$, $f(1)=3$\period 为啥? 看二元一次方程组
    \begin{align*}
        \begin{cases}
            2 = -a + b, \\
            3 = a + b \period
        \end{cases}
    \end{align*}
    二式相加, 可得 $5 = 2b$\period 可是, 如果 $b$ 是整数, 那么 $2b$ 是偶数\period 偶数 $2b$ 不可能等于奇数 $5$ 呀!
\end{example}

具体地说, 设次低于节点数 $n+1$ 的多项式
\begin{align*}
    f(x) = \sum_{i=0}^n a_i x^i = a_0 + a_1 x + \cdots + a_n x^n \in \FF[x]
\end{align*}
适合
\begin{align*}
    f(x_i) = y_i \quad (i = 0,1,\cdots,n),
\end{align*}
则可得到下面的方程组:
\begin{align*}
    \begin{cases}
        y_0 = 1 a_0 + x_0 a_1 + \cdots + x_0^n a_n, \\
        y_1 = 1 a_0 + x_1 a_1 + \cdots + x_1^n a_n, \\
        \cdots \cdots \cdots \cdots \cdots \cdots \cdots \cdots
        \cdots \cdots \cdots \cdots,                \\
        y_n = 1 a_0 + x_n a_1 + \cdots + x_n^n a_n \period
    \end{cases}
\end{align*}
这是一个有 $n+1$ 个 $n+1$ 元一次方程的方程组, 且未知元是 $a_0$, $a_1$, $\cdots$, $a_n$\period 假如我们能解出这个方程组, 且这个方程组的解 ``不超出 $\FF$ 的范围'' (我们说, 上面的二元一次方程组超出了 $\ZZ$ 的范围, 但没有超出 $\FF$ 的范围), 那么就能说明 ``多项式的次低于节点数'' 这个 ``附加条件'' 是 ``松紧得当的''\period

可惜, 我们在初中并没有研究一般的多元一次方程组\period 我们在学习二 (三) 元一次方程组的时候, 主要学习怎么用代入消元法与加减消元法解方程组, 并没有过多地讨论方程组什么时候有解与解的结构这样的问题\period

我们换一个角度看问题\period 首先, 我们有如下命题:

\begin{proposition}
    设 $t_0$, $t_1$, $\cdots$, $t_{s-1} \in \FF$ 互不相同\period 则 $t_0$, $t_1$, $\cdots$, $t_{s-1}$ ($1 \leq s \leq n$) 是 $n$ 次多项式 $f(x)$ 的根的一个必要与充分条件是: 存在 $n-s$ 次多项式 $q(x) \in \FF[x]$ 使
    \begin{align*}
        f(x) = (x - t_0)(x - t_1) \cdots (x-t_{s-1}) q(x) \period
    \end{align*}
\end{proposition}

\begin{pf}
    先看充分性\period 既然 $f(x)$ 能写为这种形式, 将 $x$ 换为 $t_i$ ($i = 0$, $1$, $\cdots$, $s-1$), 则有 $f(t_i) = 0$\period

    再看必要性\period 因为 $t_0$ 是 $f(x)$ 的根, 故存在 $n-1$ 次多项式 $q_1 (x) \in \FF[x]$ 使
    \begin{align*}
        f(x) = (x - t_0) q_1 (x) \period
    \end{align*}
    设 $t_j$ 是 $t_1$, $t_2$, $\cdots$, $t_{s-1}$ 的一个\period 则 $t_j \neq t_0$\period 因为 $t_j$ 也是 $f(x)$ 的根, 故
    \begin{align*}
        (t_j - t_0) q_1 (t_j) = f(t_j) = 0 = (t_j - t_0) 0 \period
    \end{align*}
    根据消去律, $q_1 (t_j) = 0$\period 这样, $t_1$, $\cdots$, $t_{s-1}$ 这 $s-1$ 个 $\FF$ 中元是 $q_1 (x)$ 的根\period 所以, 对 $q_1 (x)$ 来说, 存在 $n-1-1 = n-2$ 次多项式 $q_2 (x) \in \FF[x]$ 使
    \begin{align*}
        q_1 (x) = (x - t_1) q_2 (x) \implies f(x) = (x - t_0) (x - t_1) q_2 (x),
    \end{align*}
    且 $t_2$, $\cdots$, $t_{s-1}$ 这 $s-2$ 个 $\FF$ 中元是 $q_2 (x)$ 的根\period 再将这个过程进行 $s-2$ 次, 可得到 $n-s$ 次多项式 $q_s (x) \in \FF[x]$ 使
    \begin{align*}
        f(x) = (x - t_0) (x - t_1) \cdots (x - t_{s-1}) q_s (x) \period
    \end{align*}
    取 $q(x) = q_s (x)$ 即可\period
\end{pf}

\begin{example}
    我们考虑非常特殊的情形\period 如果 $y_0$, $y_1$, $\cdots$, $y_n$ 中恰有一个是 $1$, 而剩下的全是 $0$, 那这样的多项式应该长什么样呢?

    以 $y_0 = 1$, $y_1 = y_2 = \cdots = y_n = 0$ 为例\period 这样, 多项式 $f(x)$ 有根 $x_1$, $x_2$, $\cdots$, $x_n$\period 根据上个命题, 存在多项式 $q(x)$ 使
    \begin{align*}
        f(x) = q(x) (x - x_1) (x - x_2) \cdots (x - x_n) \period
    \end{align*}
    因为 $f(x)$ 的次低于 $n+1$, 而 $(x - x_1) (x - x_2) \cdots (x - x_n)$ 的次为 $n$, 故 $q(x)$ 一定是非零的数 $c$, 即
    \begin{align*}
        f(x) = c (x - x_1) (x - x_2) \cdots (x - x_n) \period
    \end{align*}
    因为 $f(x_0) = y_0 = 1$, 故
    \begin{align*}
        1 = c (x_0 - x_1) (x_0 - x_2) \cdots (x_0 - x_n),
    \end{align*}
    也就是
    \begin{align*}
        c = \frac{1}{(x_0 - x_1) (x_0 - x_2) \cdots (x_0 - x_n)} \period
    \end{align*}
    故
    \begin{align*}
        f(x) = \frac{(x - x_1) (x - x_2) \cdots (x - x_n)}{(x_0 - x_1) (x_0 - x_2) \cdots (x_0 - x_n)} \period
    \end{align*}

    类似地, 适合条件 $y_1 = 1$, $y_0 = y_2 = y_3 = \cdots = y_n = 0$ 的多项式是
    \begin{align*}
        \frac{(x - x_0)(x - x_2)(x - x_3) \cdots (x - x_n)}{(x_1 - x_0)(x_1 - x_2)(x_1 - x_3) \cdots (x_1 - x_n)} \period
    \end{align*}
    可以将这个多项式简单地写为
    \begin{align*}
        \prod_{\begin{smallmatrix}0 \leq \ell \leq n \\\ell \neq 1\end{smallmatrix}} \frac{x - x_\ell}{x_1 - x_\ell} \period
    \end{align*}
    上面的 $f(x)$ 也可以写为
    \begin{align*}
        \prod_{\begin{smallmatrix}0 \leq \ell \leq n \\\ell \neq 0\end{smallmatrix}} \frac{x - x_\ell}{x_0 - x_\ell} \period
    \end{align*}
\end{example}

回到一般的设定 (也就是说, $y_0$, $y_1$, $\cdots$, $y_n$ 是 $\FF$ 的任意元)\period 作 $n+1$ 个多项式
\begin{align*}
    L_{i} (x) = \prod_{\begin{smallmatrix}0 \leq \ell \leq n \\\ell \neq i\end{smallmatrix}} \frac{x - x_\ell}{x_i - x_\ell} \quad (i = 0,1,\cdots,n) \period
\end{align*}
不难看出, 任取 $i,j = 0,1,\cdots,n$,
\begin{align*}
    L_{i} (x_j) = \begin{cases}
        1, \quad i = j; \\
        0, \quad i \neq j \period
    \end{cases}
\end{align*}
所以,
\begin{align*}
    f(x) = \sum_{i = 0}^{n} y_i L_{i} (x) = y_0 L_0 (x) + y_1 L_1 (x) + \cdots + y_n L_n (x)
\end{align*}
适合条件
\begin{align*}
    f(x_i) = y_i \quad (i = 0,1,\cdots,n),
\end{align*}
且
\begin{align*}
    \deg f(x) \leq n < n + 1 \period
\end{align*}

综合上面的事实, 我们已经证明了

\begin{proposition}
    设 $x_0$, $x_1$, $\cdots$, $x_{n}$ 是 $\FF$ 的 $n+1$ 个互不相同的元\period 设 $y_0$, $y_1$, $\cdots$, $y_{n} \in \FF$\period 存在唯一的多项式
    \begin{align*}
        f(x) = \sum_{i = 0}^{n} y_i \prod_{\begin{smallmatrix}0 \leq \ell \leq n \\\ell \neq i\end{smallmatrix}} \frac{x - x_\ell}{x_i - x_\ell}
    \end{align*}
    适合条件
    \begin{align*}
        f(x_i) = y_i \quad (i = 0,1,\cdots,n),
    \end{align*}
    且
    \begin{align*}
        \deg f(x) < n + 1 \period
    \end{align*}
    这个公式以 ``Lagrange 插值公式'' \term{Lagrange's interpolation formula} 之名闻名全球\period
\end{proposition}

\begin{remark}
    我们在前面接触的线性无关的多项式组 (几乎都) 是次不等的多项式\period Lagrange 插值公式告诉我们, $L_0 (x)$, $L_1 (x)$, $\cdots$, $L_n (x)$ 适合:

    (i) $L_0 (x)$, $L_1 (x)$, $\cdots$, $L_n (x)$ 是线性无关的;

    (ii) 任意次不高于 $n$ 的多项式都可唯一地写为 $L_0 (x)$, $L_1 (x)$, $\cdots$, $L_n (x)$ 的线性组合\period
\end{remark}

\begin{example}
    取 $n = 2$\period 取
    \begin{align*}
         & x_0 = -1, \quad x_1 = 1, \quad x_2 = 2,        \\
         & y_0 = -1, \quad y_1 = 1, \quad y_2 = 5 \period
    \end{align*}
    计算 $L_0 (x)$, $L_1 (x)$, $L_2 (x)$:
    \begin{align*}
         & L_0 (x) = \prod_{\begin{smallmatrix}0 \leq \ell \leq 2 \\\ell \neq 0\end{smallmatrix}} \frac{x - x_\ell}{x_0 - x_\ell} = \frac{(x - 1)(x - 2)}{(-1 - 1)(-1 - 2)} = \frac16 x^2 - \frac12 x + \frac13, \\
         & L_1 (x) = \prod_{\begin{smallmatrix}0 \leq \ell \leq 2 \\\ell \neq 1\end{smallmatrix}} \frac{x - x_\ell}{x_1 - x_\ell} = \frac{(x + 1)(x - 2)}{(1 + 1)(1 - 2)} = -\frac12 x^2 + \frac12 x + 1,        \\
         & L_2 (x) = \prod_{\begin{smallmatrix}0 \leq \ell \leq 2 \\\ell \neq 2\end{smallmatrix}} \frac{x - x_\ell}{x_2 - x_\ell} = \frac{(x + 1)(x - 1)}{(2 + 1)(2 - 1)} = \frac13 x^2 - \frac13 \period
    \end{align*}
    所以, 适合条件
    \begin{align*}
         & f(-1) = -1, \quad f(1) = 1, \quad f(2) = 5, \\
         & \deg f(x) < n + 1 = 3
    \end{align*}
    的多项式 $f(x)$ 就是
    \begin{align*}
             & (-1)L_0 (x) + 1L_1 (x) + 5L_2 (x)  \\
        = {} & -L_0 (x) + L_1 (x) + 5L_2 (x)      \\
        = {} & -\frac16 x^2 + \frac12 x - \frac13
        - \frac12 x^2 + \frac12 x + 1
        + \frac53 x^2 - \frac53                   \\
        = {} & x^2 + x - 1 \period
    \end{align*}
    这跟前面用三元一次方程组算出的答案完全一致\period
\end{example}

\begin{example}
    取 $n = 3$\period 在上例的基础上, 追加
    \begin{align*}
        x_3 = -2, \quad y_3 = -11 \period
    \end{align*}
    我们的目标是: 找多项式 $f(x)$ 适合条件
    \begin{align*}
         & f(-1) = -1, \quad f(1) = 1, \quad f(2) = 5, \quad f(-2) = -11, \\
         & \deg f(x) < n + 1 = 4 \period
    \end{align*}
    在原理上, 并没有什么复杂的地方\period 求出 $L_0 (x)$, $L_1 (x)$, $L_2 (x)$, $L_3 (x)$ 后, 答案就出来了:
    \begin{align*}
        f(x)
        = {} & - \frac{(x-1)(x-2)(x+2)}{(-1-1)(-1-2)(-1+2)} + \frac{(x+1)(x-2)(x+2)}{(1+1)(1-2)(1+2)}                          \\
             & + 5 \cdot \frac{(x+1)(x-1)(x+2)}{(2+1)(2-1)(2+2)} - 11 \cdot \frac{(x+1)(x-1)(x-2)}{(-2+1)(-2-1)(-2-2)} \period
    \end{align*}
    不过, 实践告诉我们, 拆开 $4$ 个 $3$ 次多项式后再相加可不是什么轻松的事儿——至少比前一个例复杂一些\period 而且, 加一个节点后, $L_0 (x)$, $L_1 (x)$, $L_2 (x)$ (跟之前相比) 都要多乘一个一次多项式\period 有无稍微容易一些的算法呢?
\end{example}
